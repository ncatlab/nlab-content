testtest


From nForum discussion [here](https://nforum.ncatlab.org/discussion/17499/nakayamas-lemma/?Focus=114457#Comment_114457):

***

I'd like to tentatively suggest replacing the current statement of [[Nakayama's lemma]] on the relevant page with the following (non-local) version: 

> **Nakayama's lemma (proposed version):** Let $R$ be a commutative ring and $M$ be a finitely generated $R$-module. Then:
>
> 1. $\text{supp}(M) = \mathcal{V}(Ann(M))$.
>
> 2. If moreover $I\subseteq R$ is an ideal with $supp(M)\cap V(I)$ inhabited, then $M\otimes_{R} R/I$ is nonzero. 
>
> (Recall that $supp(M) = \{\mathfrak{p}\in Spec(R)\ \text{ s.t. }\ M\otimes_{R} R_{\mathfrak{p}}\ \text{ is nonzero}\}$, $Ann(M) = \{f \in R\ \text{ s.t. }\ f M = 0\}$, and $\mathcal{V}(I) = \{\mathfrak{p} \in Spec(R)\ \text{ s.t. }\ \mathfrak{p} \supseteq I\}$. The first claim is not usually considered part of Nakayama's lemma but will be useful here and can be proved with a closely related argument to that which we will use for the main result.)

The proof uses relatively little pre-existing commutative algebraic theory (i.e., just some basic facts about $\mathcal{V}$, nonzeroness in short exact sequences, localization, tensoring, and localizing/tensoring cyclic modules) as follows:

> *Proof of Nakayama's lemma:* The argument proceeds in the following four steps:
>
> 1. As $M$ is finitely generated, it admits a filtration with cyclic cokernels. To be explicit, if the $n$-tuple of elements $(m_{k}\in M)_{k=0,\dots,n-1}$ generates $M$, then it begets an $n$-tuple of short exact sequences 
\[\left(\ 0 \to M_{k} \to M_{k+1} \to R/I_{k} \to 0\ \right)_{k=0,\dots,n-1},\] 
where $M_{k}$ is the submodule of $M$ spanned by $(m_{k}\in M)_{k=0,\dots,k-1}$ and in particular $M_{0}=0$ and $M_{n}=M$. (Here the maps $M_{k} \to M_{k+1}$ are the evident inclusions; as the cokernel is generated by the image of $m_{k}$, it is in particular isomorphic to $R/I_{k}$ for some ideal $I_{k}\subseteq R$.) The basic idea is that the process of extension by which $M$ is built up from these $R/I_{k}$s interacts sufficiently nicely with the operations of localization/taking fibers that the properties of the latter determine those of the former.
> 
> 2. For instance, it is clear that any $f \in Ann(M)$ must descend to $0$ on all the $R/I_{k}$s; on the other hand, for all $k=0,\dots,n-1$ we have that $I_{k}M_{k+1} \subseteq M_{k}$. We conclude that $\prod_{k=0}^{n-1} I_{k} \subseteq Ann(M) \subseteq \bigcap_{k=0}^{n-1} I_{k}$, whence $\mathcal{V}(Ann(M)) = \bigcup_{k=0}^{n-1} \mathcal{V}(I_{k})$.
>
> 3. Let us now show that $supp(M) = \bigcup_{k=0}^{n-1} \mathcal{V}(I_{k})$; this will complete the proof of our first claim. Recall that for any $\mathfrak{p}\in Spec(R)$ the functor $-\otimes_{R} R_{\mathfrak{p}}$ is exact; we therefore in any case obtain an $n$-tuple of short exact sequences 
\[\left(\ 0 \to M_{k} \otimes_{R} R_{\mathfrak{p}} \to M_{k+1} \otimes_{R} R_{\mathfrak{p}} \to R/I_{k} \otimes_{R} R_{\mathfrak{p}} \to 0\ \right)_{k=0,\dots,n-1}.\] 
If $\mathfrak{p} \notin \bigcup_{k=0,\dots,n-1} \mathcal{V}(I_{k})$, then each $R/I_{k} \otimes_{R} R_{\mathfrak{p}}$ vanishes, so the above SESs collapse to isomorphisms 
\[\left(\ 0 \to M_{k} \otimes_{R} R_{\mathfrak{p}} \to M_{k+1} \otimes_{R} R_{\mathfrak{p}} \to 0\ \right)_{k=0,\dots,n-1}\]
and thus 
\[M \otimes_{R} R_{\mathfrak{p}} \simeq M_{n} \otimes_{R} R_{\mathfrak{p}} \simeq M_{0} \otimes_{R} R_{\mathfrak{p}} \simeq 0.\] 
Conversely, if $\mathfrak{p} \notin \bigcup_{k=0,\dots,n-1} \mathcal{V}(I_{k})$, then there is a maximal index $k_{max}$ such that $\mathfrak{p} \supseteq I_{k_{max}}$ and in particular an epimorphism 
\[M_{k_{max}+1} \otimes_{R} R_{\mathfrak{p}} \to R/I_{k_{max}} \otimes_{R} R_{\mathfrak{p}} \to 0,\]
with $R/I_{k_{max}} \otimes_{R} R_{\mathfrak{p}}$ nonzero. But there are also, as before, isomorphisms
\[\left(\ 0 \to M_{k} \otimes_{R} R_{\mathfrak{p}} \to M_{k+1} \otimes_{R} R_{\mathfrak{p}} \to 0\ \right)_{k=k_{max}+1,\dots,n-1}\]
whence
\[M \otimes_{R} R_{\mathfrak{p}} \simeq M_{n} \otimes_{R} R_{\mathfrak{p}} \simeq M_{k_{max}+1} \otimes_{R} R_{\mathfrak{p}}\] 
is epic onto a nonzero module and thus itself nonzero.
>
> 4. The proof of the second claim is in the same vein, requiring just a little bit more delicacy. Suppose that $\mathfrak{p}$ inhabits $\text{supp}(M)\cap V(I)$; by the above this means that $\mathfrak{p}\supseteq I$ and that there exists some index $k$ for which $\mathfrak{p}\supseteq I_{k}$. Again consider the maximal index $k_{max}$ for which $\mathfrak{p} \supseteq I_{k_{max}}$. As before, there is an epimorphism 
\[M_{k_{max}+1} \otimes_{R} R_{\mathfrak{p}} \to R/I_{k_{max}} \otimes_{R} R_{\mathfrak{p}} \to 0\] 
and isomorphisms 
\[\left(\ 0 \to M_{k} \otimes_{R} R_{\mathfrak{p}} \to M_{k+1} \otimes_{R} R_{\mathfrak{p}} \to 0\ \right)_{k=k_{max}+1,\dots,n-1}\]
By the right-exactness of the functor $-\otimes_{R} R/\mathfrak{p}$, we obtain from the former an epimorphism 
\[M_{k_{max}+1} \otimes_{R} R_{\mathfrak{p}} /\mathfrak{p} \to R/I_{k_{max}} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \to 0\] 
(implicitly using that $(- \otimes_{R} R_{\mathfrak{p}})\otimes_{R} R/\mathfrak{p}\ \simeq\ - \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p}$). 
By its functoriality, there are likewise isomorphisms
\[\left(\ 0 \to M_{k} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \to M_{k+1} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \to 0\ \right)_{k=k_{max}+1,\dots,n-1}\]
Now,
\[R/I_{k_{max}} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \simeq R_{\mathfrak{p}}/\mathfrak{p}\] 
is nonzero (here we use that $\mathfrak{p} \supseteq I_{k_{max}}$). It follows that 
\[M \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \simeq M_{n} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \simeq M_{k_{max}+1} \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p}\]
is epic onto a nonzero module and thus itself nonzero.
But 
\[M \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p} \simeq (M \otimes_{R} R/I) \otimes_{R} R_{\mathfrak{p}}/\mathfrak{p}\]
(here we use that $\mathfrak{p} \supseteq I$), so the latter must itself be nonzero, as claimed. $\blacksquare$

It is now straightforward to recover more familiar forms of Nakayama's lemma as a corollary of the above. For instance, the nLab's current version states:

> **Nakayama's lemma (nLab's version):** Let $R$ be a local ring with maximal ideal $\mathfrak{m}\subseteq R$ and $M$ be a finitely generated $R$-module. Then if $M$ is nonzero, so too is $M \otimes_R R/\mathfrak{m}$. 

Indeed, $\mathfrak{m}$ is practically tautologically in (and so $\mathcal{V}(\mathfrak{m})$ practically tautologically intersects) the support of any nonzero $R$-module; the conditions of our version of the lemma apply, and we conclude that $M \otimes_R R/\mathfrak{m}$ is nonzero as advertised. $\blacksquare$

Sometimes (for instance in the [Stacks Project](https://stacks.math.columbia.edu/tag/07RC)), Nakayama's lemma is stated instead as follows:

> **Nakayama's lemma (Stacks Project's version):** Let $R$ be a commutative ring, $M$ be a finitely generated $R$-module, and $I\subseteq R$ be an ideal with $I M = M$. Then there exists $f\in R$ such that $f = 1\ (mod\ I)$ and $f M=0$.

Of course, $I M = M\ \iff\ M \otimes_{R} R/I \simeq 0$; it follows from our version of the lemma that $I$ is comaximal with $Ann(M)$. The [Chinese Remainder theorem](https://stacks.math.columbia.edu/tag/00DT) then asserts the existence of $f\in R$ such that $f = 1\ (mod\ I)$ and $f = 0\ (mod\ Ann(M))$; the desired $f$. $\blacksquare$

***


