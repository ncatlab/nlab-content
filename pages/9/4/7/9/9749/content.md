
+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
### Context
#### Measure and probability theory
+-- {: .hide}
[[!include measure theory - contents]]
=--
=--
=--


# Contents
* table of contents
{: toc}

## Idea

The _Giry monad_ ([Giry 80](#Giry80), following [Lawvere 62](#Lawvere62)) is the [[monad]] on a [[category]] of suitable [[spaces]] which sends each suitable space $X$ to the space of suitable [[probability measures]] on $X$.

It is one of the main examples of a [[probability monad]], and hence one of the main structures used in [[categorical probability]].


## Definition

The *Giry monad* is defined on the category of [[measurable spaces]], assigning to each measurable space $X$ the space $G(X)$ of all [[probability measures]] on $X$ endowed with the [[sigma-algebra|$\sigma$-algebra]] generated by the set of all the [[evaluation maps]] 
$$
  ev_U \colon G(X) \to [0,1]
$$ 
sending a probability measure $P$ to $P(U)$, where $U$ ranges over all the measurable sets of $X$. The unit of the monad sends a point $x \in X$ to the [[Dirac measure]] at $x$, $\delta_x$, while the [[monad]]-multiplication is defined by the [[natural transformation]] 
$$
  \mu_{X}
  \;\colon\; 
  G\big(G(X)\big) 
  \longrightarrow 
  G(X)
$$

given by

$$
  \mu_X (Q)(U) 
  \;\coloneqq\; 
  \textstyle{\int}_{q \in G(X)} 
  ev_U(q) 
  \,dQ
  \,.
$$

This makes the [[endofunctor]] $G$ into a [[monad]], and as such this is the _Giry monad_ on measurable spaces, as originally defined by [Lawvere 1962](#Lawvere62).

An alternative choice, convenient for analysis purposes, and introduced by Giry, is obtained by restricting the category of [[measurable spaces]] to the (full) subcategory which are those measurable spaces generated by [[Polish spaces]], $Pol$, which are  separable [[metric spaces]] for which a complete metric exists.  The morphisms of this category are continuous functions.

Write 

$$
  P \colon Pol \to Pol
$$

for the [[endofunctor]] which sends a space, $X$, to the space of [[probability measures]] on the [[Borel subsets]] of $X$. $P(X)$ is equipped with the weakest [[topology]] which makes the [[integration]] map $\tau \mapsto \int_{X}f d\tau$ [[continuous function|continuous]] for any $f$, a bounded, continuous, real function on $X$. 

There is a [[natural transformation]] 

$$
  \mu_{X}: P(P(X)) \to P(X)
$$

given by

$$
 \mu_X (M)(A) := \int_{P(X)} \tau(A) M(d\tau).
$$

This makes the [[endofunctor]] $P$ into a [[monad]], and this is the _Giry monad_ on [[Polish spaces]].  

## Properties

### Giry Monad on Standard spaces

Every probability measure on a [[Standard Borel space]]  is a [[Radon measure]]. So, on compact Polish spaces, the Giry monad coincides with the measurable sets of the [[Radon monad]]. Do note that not every measurable map is continuous with regard to the topology of the Radon monad. This applies to algebras also — for example, the Giry algebra on $[0, \infty]$ is not continuous.

The Giry monad on Polish spaces uses the weak topology, which is weaker than the weak* topology of the [[Radon monad]].

### Kleisli category

The [[Kleisli morphisms]] of the Giry monad on [[Meas]] (and related subcategories) are [[Markov kernels]]. Therefore its [[Kleisli category]] is the category [[Stoch]]. 
It is one of the most important examples of a [[Markov category]].

### Algebras over the Giry monad
We can't say much about the $G$-algebras on the category of measurable spaces due to lack of structure and set-theoretical issues.  However, the $G$ monad restricts to the full subcategory of [[standard Borel space]] where we can construct a factorization of the $G$ monad which allows us to understand how $G$ algebras arise via expectation maps.
   
If $X$ is any standard space then the space of probability measures $G{X}$ is a [[superconvex space]] with the structure defined pointwise: if $\{P_i\}_{i=1}^{\infty}$ is a countable collection of probability measures on $X$  then, for every sequence $\{p_i\}_{i=1}^{\infty}$ with each $p_i \in [0,1]$ such that $\sum_{i=1}^{\infty} p_i = 1$, the countable affine sum  $\sum_{i=1}^{\infty} p_i P_i$,  is also a probability measure, defined at the measurable set $U$ in $X$ by
\begin{equation}
\big(\sum_{i=1}^{\infty} p_i P_i\big)(U) = \sum_{i=1}^{\infty} p_i P_i(U).
\end{equation}
By restriction to finite affine sums $G{X}$ can also be viewed as a convex space.

\begin{lemma} \label{FunThm} Given any $G$-algebra $h: G{X} \to X$ the base space $X$ has the structure of a convex space which makes the measurable function $h$ an affine (measurable) map. Moreover, morphisms of $G$-algebras are also affine maps.
\end{lemma}
\begin{proof} Given $h$ define the convex space structure on $X$ by
\begin{equation}
 \sum_{i=1}^{n} p_i x_i := h(\sum_{i=1}^{n} p_i \delta_{x_i}).
\end{equation}

Because a $G$-algebra $h$ must satisfy $h \circ \mu_X = h \circ G{h}$ we have, for any finite sequence $Q_i \in GX$, 
\begin{equation}
\begin{array}{lcl}
(h \circ \mu_X)( \sum_{i=1}^{n} p_i \delta_{Q_i}) &=& (h \circ G{h})( \sum_{i=1}^{n} p_i \delta_{Q_i}) \\
h( \sum_{i=1}^{n} p_i Q_i) &=& h(\sum_{i=1}^{n} p_i \, \delta_{h(Q_i)}) \\
 &=& \sum_{i=1}^{n} p_i h(Q_i)
\end{array}
\end{equation}
where the last line makes use of the definition of the convex structure on $X$. Thus, every $G$-algebra is affine.

To prove that any map of $G$-algebras $f: (X, h) \to (Y, k)$ is an affine map, we compute
\begin{equation}
\begin{array}{lcll}
f(\sum_{i=1}^{n} p_i x_i) &=& f(h(\sum_{i=1}^{n} p_i \delta_{x_i})) &  \\
&=& k(G(f)(\sum_{i=1}^{n} p_i \delta_{x_i}) &  \\
&=& k(\sum_{i=1}^{n} p_i \delta_{f(x_i)}) &  \\
&=& \sum_{i=1}^{n} p_i f(x_i) & 
\end{array}.
\end{equation}

\end{proof}

Let $\mathbf{Std}\cap \mathbf{Cvx}$ be the category of standard spaces with a convex space structure with morphisms being affine measurable functions.  Let $\mathbb{R}_{\infty}$ be the one-point compactification of the real-line.  $\mathbb{R}_{\infty}$ is a second-countable compact Hausdorff space so it is a [[Polish space]], and hence $\mathbb{R}_{\infty}$ with the Borel $\sigma$-algebra is a standard space.  Let $\mathbf{Std} \cap \mathbf{Cvx}$ denote  
the category whose objects are standard spaces with a convex space structure, and whose morphisms are affine measurable functions. Because $\mathbb{R}_{\infty}$ is a coseparator in $\mathbf{Cvx}$ it follows that $\mathbb{R}_{\infty}$ is a coseparator in $\mathbf{Std} \cap \mathbf{Cvx}$. 

Given any standard space $A$ and any $P \in G(A)$ let $\mathbf{Std}(A, \mathbb{R}_{\infty}) \xrightarrow{\tilde{P}} \mathbb{R}_{\infty}$ denote the functional sending $f \mapsto \int_A f \, dP$.  Let $\mathbb{R}_{\infty}^A = hom_{\mathbf{Std} \cap \mathbf{Cvx}}(A, \mathbb{R}_{\infty})$. Taking $A=\mathbb{R}_{\infty}$ we obtain the space $\mathbb{R}_{\infty}^{\mathbb{R}_{\infty}}$ of endomaps on $\mathbb{R}_{\infty}$.  Recall that a $\mathbb{R}_{\infty}$-generalized point of $A$ is a functional $\tilde{P}$ satisfying, for all $\phi \in \mathbb{R}_{\infty}^{\mathbb{R}_{\infty}}$ and all $m \in \mathbb{R}_{\infty}^A$, the equation 
\begin{equation}
\phi \big( \tilde{P}(m) \big) = \tilde{P}(\phi \circ m).
\end{equation}
The reader can verify than any such $\mathbb{R}_{\infty}$-generalized element $\tilde{P}$ is $\mathbb{R}_{\infty}$-linear, weakly averaging, and additive.  Since $\tilde{P}$ is defined in terms of the Lebesque integral we have, more generally, 
\begin{lemma} Every $\mathbb{R}_{\infty}$-generalized element $\mathbb{R}_{\infty}^A \xrightarrow{\tilde{P}} \mathbb{R}_{\infty}$ of $A$ is countably additive.
\end{lemma}
\begin{proof} Given a countable sequence $\{A \xrightarrow{f_i} \mathbb{R}_{\infty}\}_i$ of measurable functions let $g_n=\sum_{i=1}^n f_i$.  Since $f_i\ge 0$ we have, by the monotone convergence theorem
$\tilde{P}(\sum_{i} f_i) = \tilde{P}(\lim_n g_n) = \lim_n \{\tilde{P}(g_n)\} = \lim_n \sum_{i=1}^n \tilde{P}(f_i) = \sum_i \tilde{P}(f_i)$.
\end{proof}

We say an object $A$ in $\mathbf{Std} \cap \mathbf{Cvx}$ satisfies the fullness property if and only if for every $P \in G(A)$ the property
\begin{equation}
\displaystyle{ \bigcap_{m \in \mathbb{R}_{\infty}^A}} m^{-1}\big(\tilde{P}(m)\big) = \{a \in A \, | \, \tilde{P}(m)=m(a) \quad \forall m \in \mathbb{R}_{\infty}^A\} \ne \emptyset
\end{equation}
holds.

\begin{lemma} \label{ff} Every $\mathbb{R}_{\infty}$-generalized element $\tilde{P}$ of $A$ which satisfies the fullness property is a point, i.e, $\tilde{P} =ev_a$ for a unique element $a \in A$. ($ev_a$ is the evaluation map at the point $a$.)
\end{lemma} 
\begin{proof} Since the fullness property is satisfied there exist at least one element $a \in A$ such that $\tilde{P}(m)=m(a)$. 
Since $A$ lies in $\mathbf{Std} \cap \mathbf{Cvx}$ is coseparated by $\mathbb{R}_{\infty}$ there is at most one element $a \in A$ satisfying, for all affine measurable maps $A \xrightarrow{m} \mathbb{R}_{\infty}$, the equation $\tilde{P}(m)=m(a)$.  
\end{proof}

Define $\mathbf{Std}_{Cvx}$ to be the full subcategory of $\mathbf{Std} \cap \mathbf{Cvx}$ consisting of those objects which satisfy the fullness property.  

Note that $\mathbb{R}_{\infty}$ is an object in $\mathbf{Std}_{SCvx}$. (This is exercise 8.23 in the text Sets for Mathematics by Lawvere and Rosebrugh. Moreover, the expectation mapping $G(\mathbb{R}_{\infty}) \xrightarrow{\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})} \mathbb{R}_{\infty}$ is easily verified to be a $G$-algebra.)

We now proceed to show that for every standard space $X$ that $G(X)$ is an object in $\mathbf{Std}_{Cvx}$.  

\begin{lemma} Let $(X, \sigma(\mathbb{F}))$ be a standard space.  Then for $Q \in \G^2(X)$ we have
$$\displaystyle{ \bigcap_{U \in \mathbb{F}}} ev_U^{-1}\big( \tilde{Q}(ev_U) \big) = \mu_X(Q)$$
\end{lemma} 
\begin{proof}We have
\begin{equation}
ev_U^{-1}\big( \tilde{Q}(ev_U) \big) = \{R \in G(X) \, | \, R(U)=\mu_X(Q)[U] \}
\end{equation}
so taking the intersection over all elements in the generating field (with a basis) yields the result using the well known result if $X$ is a standard space and $P,R \in G(X)$ satisfy $P(U)=R(U)$ for all $U \in \mathbb{F}$ then $P=R$.
\end{proof}

\begin{lemma} Let $(X, \sigma(\mathbb{F}))$ be a standard space. Then every affine measurable function $G(X) \xrightarrow{m} V$ is a countable affine sum of the form $m = \sum_i \lambda_i ev_{U_i}$ where $\lambda_i \in V$ and $U_i \in \mathbb{F}$.
\end{lemma}
\begin{proof} The superconvex space structure of $G(X)$ is defined by the countable family of equations
$ ev_U( \sum_{i=1}^{\infty} p_i P_i) = \sum_{i=1}^{\infty}p_i P_i(U)$ 
for all $U \in \mathbb{F}$. Any countable linear sum of the elements $\{ev_U\}_{U \in \mathbb{F}}$ therefore defines a countable affine map $G(X) \xrightarrow{ \lambda_j ev_{U_j}} \mathbb{R}_{\infty}$. (Any constant transformation by $c$ can be represented by a term $c ev_X$ since $c ev_X(P) = c$. Hence we can refer to countable linear sums instead of countable affine sums.)

Conversely, for a set function $G(X) \xrightarrow{m} \mathbb{R}_{\infty}$ to  preserve the superconvex space structure of $G(X)$ which is defined in terms of the elements $ev_U$ it must be a countable linear transformation of those elements.  Indeed, for any measurable function $X \xrightarrow{f} \mathbb{R}_{\infty}$ the function $G(X) \xrightarrow{\int_X f \, d{\bullet}} \mathbb{R}_{\infty}$ is, by the definition of the Lebesque integral, given by
$\int_X f \, dP = \big(\sum_{i \in \mathbb{Nat}} \lambda_i ev_{U_i}\big)P$
where $\psi_n = \sum_{i=1}^{N_n} \lambda_{n,i} \chi_{U_{n,i}}$ is a simple function satisfying $\psi_n \le f$ and for which $\{\psi_n\}_{n=1}^{\infty}$ converges pointwise to $f$.
\end{proof}

\begin{lemma}Let $(X, \sigma(\mathbb{F}))$ be a standard space. Then
\begin{equation}
\displaystyle{ \bigcap_{G(X) \xrightarrow{m} \mathbb{R}_{\infty}}}m^{-1}\big(\tilde{Q}(m)\big) =\mu_X(Q)  = \displaystyle{\bigcap_{U \in \mathbb{F}}} ev_U^{-1}\big( \tilde{Q}(ev_U) \big).
\end{equation}
\end{lemma}
\begin{proof} Since every $\mathbb{R}_{\infty}$-generalized point $\tilde{Q}$ of $G(X)$ is $\mathbb{R}_{\infty}$-linear and countably additive it follows that $\tilde{Q}(\sum_i \lambda_i ev_{U_i}) = \sum_i \lambda_i \tilde{Q}(ev_{U_i})$. Thus 
$(\sum_i \lambda_i ev_{U_i})^{-1}(\tilde{Q}(\sum_i \lambda_i ev_{U_i}) = \{ P \in G(X) \, | \, \sum_i \lambda_i P(U_i) = \lambda_i \mu_X(Q)[U_i]\}$.
Now take the intersection over all such countably affine measurable functions $m$, which includes the basic functions $m=ev_U$,
$\bigcap_m (\sum_i \lambda_i ev_{U_i})^{-1}(\tilde{Q}(\sum_i \lambda_i ev_{U_i}) = \{ P \in G(X) \, | \, \sum_i \lambda_i R(U_i) = \sum_i \lambda_i \mu_X(Q)[U_i] \forall m\}$.
The only $P \in G(X)$ satisfying the right hand side term for all countably affine maps $m$ is clearly $P= \mu_X(Q)$.
\end{proof}

\begin{lemma} Let $(X, \sigma(\mathbb{F}))$ be a standard space. Then $G(X)$ is an object in $\mathbf{Std}_{Cvx}$.
\end{lemma}
\begin{proof} By the preceding lemma the space $G(X)$ satisfies the fullness property. By the well-known result that if $P,R \in G(X)$ with $P(U)=R(U)$ for all $U \in \mathbb{F}$ it follows that $P=R$, it follows that the evaluations maps $G(X) \xrightarrow{ev_U} V$ coseparate the points of $G(X)$. Hence the result follows by definition of $\mathbf{Std}_{Cvx}$.
\end{proof}
This lemma shows there exists a functor $\mathbf{Std} \xrightarrow{\hat{G}} \mathbf{Std}_{Cvx}$ which is the  Giry monad functor with codomain $\mathbf{Std}_{Cvx}$, and coupled with the partial forgetful functor $\mathbf{Std}_{Cvx} \xrightarrow{\mathcal{U}_{Cvx}} \mathbf{Std}$ which forgets the convex space structure, we obtain a factorization of the $G$ monad. (This will be an adjoint factorization once we prove some more facts.)

\begin{theorem} Let $\mathcal{R}$ denote the full subcategory of $\mathbf{Std}_{Cvx}$ consisting of the single object $\mathbb{R}_{\infty}$.
The functor defined (on objects) by
\begin{equation}
\begin{array}{ccc}
\mathbf{Std}_{Cvx}^{op} & \xrightarrow{\mathcal{Y}} & \mathbf{Set}^{\mathcal{R}} \\
A & \mapsto & \mathbf{Std}_{Cvx}(A, \bullet)
\end{array}
\end{equation}
is a full and faithful functor.
\end{theorem}
\begin{proof} 
In the category $\mathbf{Std}_{Cvx}$ every affine measurable function is determined by its value on points $1 \xrightarrow{a} A$. Hence to prove the fully faithful property it suffices to prove those properties on points.

Since $A$ lies in $\mathbf{Std}_{Cvx}$, which has $\mathbb{R}_{\infty}$ as a coseparator, the faithful property holds.  The fullness property follows from Lemma \ref{ff}.
\end{proof}

Let $\delta_a$ denote the Dirac measure at $a$.

\begin{corollary} If $A$ is an object in $\mathbf{Std}_{Cvx}$ then there exists a unique affine measurable function $G(A) \xrightarrow{\epsilon_A} A$ such that $\epsilon_A(\delta_a)=a$ for all $a \in A$. 
\end{corollary}
\begin{proof}  Let $\mathcal{R} \xrightarrow{\iota} \mathbf{Std}_{Cvx}$ denote the inclusion functor. Let $A\downarrow \iota$ denote the slice category of arrows $A \xrightarrow{m} \mathbb{R}_{\infty}$, and let $A \downarrow \iota \xrightarrow{\pi} \mathcal{R}$ denote the projection functor.
For $\mathcal{D}_A = A \downarrow \iota \xrightarrow{\pi} \mathcal{R} \xrightarrow{\iota} \mathbf{Std}_{Cvx}$ 
the theorem is equivalent to saying $A = \lim \mathcal{D}_A$ with the projection map at component $m$ being $m$.

Consider the cone over $\mathcal{D}_A$ with vertex $G(A)$ and natural transformation components $\mathbb{E}_{\bullet}(m) = \mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}}) \circ \G(m)$.
\begin{tikzpicture}
  \node  (GA) at  (3,0)  {$G(A)$};
  \node  (GV1) at (4.2,1.2) {$G(\mathbb{R}_{\infty})$};
  \node  (GV2) at (4.2,-1.2) {$G(\mathbb{R}_{\infty})$};
  \node  (A)  at (6.5,0)  {$A$};
  \node  (V1)  at (7.7,1.2) {$\mathbb{R}_{\infty}$};
  \node  (V2)  at (7.7,-1.2) {$\mathbb{R}_{\infty}$};
  \draw[->,below] (A) to node {$m$} (V1);
  \draw[->,above] (A) to node {$k$} (V2);
  \draw[->,right] (V1) to node {$\phi_{m,k}$} (V2);
  \draw[->,above,dashed] (GA) to node [xshift=7pt]{$\epsilon_A$} (A);  
  \draw[->,above] (GA) to node [xshift=-9pt]{$G(m)$} (GV1);
  \draw[->,below] (GA) to node [xshift=-7pt,yshift=5pt] {$G(k)$} (GV2);
  \draw[->,above] (GV1) to node {$\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$} (V1);
  \draw[->,below] (GV2) to node {$\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$} (V2);
 \end{tikzpicture}

Since $A=\lim \mathcal{D}_A$ there exists a unique $\mathbf{Std}_{Cvx}$-morphism   $G(A) \xrightarrow{\epsilon_A} A$ such that $m \circ \epsilon_A = \mathbb{E}_{\bullet}(m)$ for all affine maps $A \xrightarrow{m} \mathbb{R}_{\infty}$. It follows that on $\delta_a \in G(A)$ that, for all $A \xrightarrow{m} \mathbb{R}_{\infty}$ in $\mathbf{Std}_{Cvx}$ that $m(\epsilon_A(\delta_a)) = m(a)$.  Since $\mathbb{R}_{\infty}$ is a coseparator in $\mathbf{Std}_{Cvx}$ it follows $\epsilon_A(\delta_a)=a$.
\end{proof}

A more appropriate notation for the unique morphism $\epsilon_A$ is $\mathbb{E}_{\bullet}(id_A)$ which, in the special case of $A$ lying in an $\mathbb{R}$-vector space coincides with the usual interpretation.  For an arbitrary space $A$ the function $G(A) \xrightarrow{\mathbb{E}_{\bullet}(id_A)} A$ is the unique morphism such that, for every $P \in G(A)$,   $\mathbb{E}_P(id_A) \in A$ is the unique point such that $m(\mathbb{E}_{P}(id_A)) = \int_A m(a) \, dP$ for all countably affine measurable functions $A \xrightarrow{m} \mathbb{R}_{\infty}$.

\begin{lemma}
The function $\epsilon_A$ is a $G$-algebra.
\end{lemma}
\begin{proof}The property $\epsilon_A(\delta_a)=a$ follows from the preceding corollary.
To prove the property $\epsilon_A \circ \mu_A = \epsilon_A \circ G(\epsilon_A)$  compose both sides of that equation by a countably affine measurable map $A \xrightarrow{m} \mathbb{R}_{\infty}$.
If we spell both sides of that equation out, using the property $\int_A m \, d(\mu_X(Q)) = \int_{P \in \G(A)} \mathbb{E}_{P}(m) dQ$, the equation holds valid.  The result of the lemma follows from the property that $\mathbb{R}_{\infty}$ coseparates, i.e, the set of morphisms $A  \xrightarrow{m} \mathbb{R}_{\infty}$ are jointly monic on $A$.

A more detailed proof can be found in  ([Sturtz 25](#Sturtz25)).
\end{proof}

\begin{lemma} Let $A \in_{ob} \mathbf{Std}_{Cvx}$. Every affine measurable function $A \xrightarrow{m} \mathbb{R}_{\infty}$ yields a morphism of $\G$-algebras.
\end{lemma}
\begin{proof} 
By Corollary 3.9 the affine measurable function  $\epsilon_A =\mathbb{E}_{\bullet}(id_A)$ is the unique morphism in $\mathbf{Std}_{Cvx}$ such that for every $A \xrightarrow{m} \mathbb{R}_{\infty}$ the $\mathbf{Std}_{Cvx}$-diagram
\begin{tikzpicture}
  \node  (GA) at  (-1,0)  {$G(A)$};
  \node  (GR) at  (2,0)   {$G(\mathbb{R}_{\infty})$};
  \node  (A)  at   (-1,-1.5) {$A$};
  \node  (R)  at   (2, -1.5)  {$\mathbb{R}_{\infty}$};

   \draw[->,below] (A) to node {$m$} (R);
   \draw[->,above] (GA) to node {$G(m)$} (GR);
   \draw[->, left] (GA) to node {$\mathbb{E}_{\bullet}(id_A)$} (A);
   \draw[->,right] (GR) to node {$\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$} (R);
\end{tikzpicture}
commutes. But both $\mathbb{E}_{\bullet}(id_A)$ and $\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$ are $G$-algebras. Hence $m$ is a morphism of those algebras.
\end{proof}

\begin{lemma} The construction $\mathbb{E}_{\bullet}(id_A)$ is natural in the argument $A$.
\end{lemma}
\begin{proof}
The proof is straightforward using the previous lemma.
\end{proof}

Using the naturality of $\mathbb{E}$ we obtain an adjunct pair $\mathbf{Std} \xrightarrow{\hat{G}} \mathbf{Std}_{Cvx}$, which is the Giry monad (functor) viewed as a functor into $\mathbf{Std}_{Cvx}$, and the partial forgetful functor $\mathbf{Std}_{Cvx}  \xrightarrow{\mathcal{U}_{Cvx}} \mathbf{Std}$ which forgets the convex space structure, with the natural transformation $\mathbb{E}$ as the counit of the adjunction.  T
he composite functor $\mathcal{U}_{Cvx} \circ \hat{G} = G$.

Since the Giry monad factors through $\mathbf{Std}_{Cvx}$ it follows that  $\mathbf{Std}_{Cvx}$ is a subcategory of $\mathbf{Alg}_{G}$. 

\begin{theorem} $\mathbf{Std}_{Cvx} = \mathbf{Alg}_{G}$.
\end{theorem}
\begin{proof} Suppose that $(X,h)$ is a $G$-algebra so that $X$ is an object in $\mathbf{Alg}_G$.  By Lemma 3.1 $X$ has a convex space structure so $X$ is an object in $\mathbf{Std} \cap \mathbf{Cvx}$.  To show that $X$ is an object in $\mathbf{Std}_{Cvx}$ we only need to verify that $X$ satisfies the fullness condition.

Take any affine measurable function $X \xrightarrow{m} \mathbb{R}_{\infty}$.  We claim that $(X,h) \xrightarrow{m} (\mathbb{R}_{\infty}, \mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$ is a morphism of $G$-algebras.  In other words, the right-hand side of the $\mathbf{Std}$-diagram
\begin{tikzpicture}
   \node (G2X) at (-4,0) {$G^2(X)$};
   \node  (GX) at  (-4, -1.5) {$G(X)$};
   \node  (GX2) at  (-1,0)    {$G(X)$};
   \node  (GR)  at  (2,0)  {$G(\mathbb{R}_{\infty})$};
   \node  (X)   at  (-1, -1.5)  {$X$};
   \node  (R)   at  (2, -1.5)   {$\mathbb{R}_{\infty}$};

   \draw[->,above] (G2X) to node {$G(h)$} (GX2);
   \draw[->,right] (GX2) to node {$h$} (X);
   \draw[->,left] (G2X) to node {$\mu_X=\mathbb{E}_{\bullet}(id_{G(X)})$} (GX);
   \draw[->,below] (X) to node {$m$} (R);
   \draw[->,above] (GX2) to node {$G(m)$} (GR);
   \draw[->,below] (GX) to node {$h$} (X); 
   \draw[->,right] (GR) to node {$\mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}})$} (R);
    
\end{tikzpicture}
commutes.

To prove this note that the space $G(X)$ is, by Lemma 3.7, an object in $\mathbf{Std}_{Cvx}$, and that $\mathbb{R}_{\infty}$ is also an object in $\mathbf{Std}_{Cvx}$.  The composite map $m \circ h$ is an affine measurable map and hence an arrow in $\mathbf{Std}_{Cvx}$.  By Corollary 3.11 it follows that the outer square commutes.  Thus we have
$$ \mathbb{E}_{\bullet}(id_{\mathbb{R}_{\infty}}) \circ G(m) \circ G(h) = m \circ (h \circ \mu_X) = m \circ h \circ G(h).
$$
Now note that $G(h)$ is an epimorphism (onto) because $h$ is an epimorphism. Consequently, cancelling the term $G(h)$ on the right in the preceding equation shows that the right-hand side of the square in the diagram commutes.

Since $m$ is a morphism of $G$-algebras it follows that for all $P \in G(X)$ that $m( h(P)) = \mathbb{E}_P(m)$, which in turn implies that 
$$ h(P) \in m^{-1}\big(\mathbb{E}_P(m)\big) $$
or equivalently, $h(P) \in m^{-1}( \tilde{P}(m) )$.  This equation holds for all affine measurable maps $X \xrightarrow{m} \mathbb{R}_{\infty}$, and hence the fullness property is satisfied, i.e.,
$$ \bigcap_{m \in \mathbb{R}_{\infty}^A|} m^{-1}(\tilde{P}(m)) \ne \emptyset. $$
Consequently $X$ lies in the category $\mathbf{Std}_{Cvx}$.

The fact that every morphism in $\mathbf{Alg}_G$ is a morphism in $\mathbf{Std}_{Cvx}$ follows from Lemma 3.1.
Hence we have shown that $\mathbf{Alg}_G$ is a subcategory of $\mathbf{Std}_{Cvx}$.
\end{proof}

 
Concerning $P$ algebras, the above method of using generalized points can be used to obtain similar results. ([Doberkat 03](#Doberkat03)) gives a different representation for the algebras of $P$, although, like the Eilenberg-Moore characterization, the representation is descriptive but not constructive. (This is evident in the fact that he does not theoretically relate the algebras to the expectation mapping which characterizes the $P$-algebras.)
His representation for the algebras is based upon the idea that we want continuous maps $h:P(X) \rightarrow X$ such that the ‘fibres’ are convex and closed, and such that $\delta_x$, the Delta distribution on $x$, is in the fibre over $x$.
 And there’s another condition which requires a compact subset of $P(X)$ to be sent to a compact subset of $X$.

As an example of $P$-algebras, represented via convex spaces, Doberkat gives the example of closed and bounded convex subsets of some Euclidean space, and shows that the construction of a barycenter yields an algebra.  We summarize that construction here.

Fix $X \subset \mathbb{R}^n$ as a bounded, closed, and convex subset of the Euclidean space $\mathbb{R}^n$.
A vector $x_{\star} \in \mathbb{R}^n$ is called a barycenter of the probability measure $\tau \in P(X)$ iff, for all linear 
functionals $g$ on $\mathbb{R}^n$, the property $g(x_{\star}) = \int_X g(x) d\tau$ holds.
Since every linear functional on $\mathbb{R}^n$ is given by $g(\cdot)=\langle x, \cdot \rangle$ for a unique $x \in \mathbb{R}^n$, the defining property of a barycenter (for convex subsets of $\mathbb{R}^n$) given above is equivalent to saying that, for all $x \in \mathbb{R}^n$, the property $\langle x, x_{\star} \rangle = \int_{y \in  X} \langle x, y\rangle d\tau$ holds.
 
\begin{lemma}
The barycenter of $\tau \in P(X)$ exists, it is uniquely determined, and it is an element of $X$.
\end{lemma}

\begin{theorem}
Let $h(\tau)$ be the barycenter of $\tau \in P(X)$.  Then $(X,h)$ is an algebra for the $P$-monad.
\end{theorem}

Finally, we note that Doberkat points out that for  discrete  Polish space $X$ that $X$ is disconnected, and hence there can be no continuous map $P{X} \rightarrow \mathbf{X}$. Hence $X$, irrelavant of any convex structure we endow it with, cannot be an algebra.


## Related constructions

See also [[monads of probability, measures, and valuations]].

### Voevodsky's work

[[Vladimir Voevodsky]] has also worked on a category theoretic treatment of [[probability theory]], and gave few talks on this at IHES, Miami, in Moscow etc. Voevodsky had in mind applications in [[mathematical biology]], for example, population genetics: 

See [Miami Talk abstract](http://www.math.miami.edu/anno/voevodsky.htm)

> ...a categorical study of probability theory where "categorical" is understood in the sense of category theory. Originally, I developed this approach to probability to get a better understanding of the constructions which I had to deal with in population genetics. Later it evolved into something which seems to be also interesting from a purely mathematical point of view. On the elementary level it gives a category which is useful for the work with probabilistic constructions involving complicated combinations of stochastic processes of different types. On a more advanced level, applying in this context the old idea of a functor as a generalized object one gets a better view of the relationship between probability and the theory of (pre-)ordered topological vector spaces. 

A talk in Moscow (20 Niv 2008, in Russian) can be viewed [here](http://www.mi.ras.ru/index.php?c=obs_sem/&l=1), [wmv 223.6 Mb](http://www.mi.ras.ru/media/335_full.wmv). Abstract:

> In early 60-ies Bill Lawvere defined a category whose objects are measurable spaces and morphisms are Markov kernels. I will try to show how this category allows one to think about many of the notions of probability theory in categorical terms and to connect probabilistic objects to objects of other types through various functors.

Voevodsky's unfinished [notes on categorical probability theory](http://www.math.ias.edu/Voevodsky/voevodsky-publications_abstracts.html#markov) have been released posthumously.

### Panangaden's monad

[[Prakash Panangaden]] in [Probabilistic Relations](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.52.4840) defines the [[category]] $SRel$ (stochastic [[relation]]s) to have as [[object]]s [[set]]s equipped with a $\sigma$[[sigma-field|-field]]. [[morphism|Morphisms]] are conditional probability densities or stochastic kernels. So, a morphism from $( X, \Sigma_X)$ to $( Y, \Sigma_Y)$ is a function $h: X \times \Sigma_Y \to [0, 1]$ such that 

1. $\forall B \in \Sigma_Y . \lambda x \in X . h(x, B)$ is a bounded measurable function,
1. $\forall x \in X . \lambda B \in \Sigma_Y . h(x, B)$ is a subprobability measure on $\Sigma_Y$.

If $k$ is a morphism from $Y$ to $Z$, then $k \cdot h$ from $X$ to $Z$ is defined as $(k \cdot h)(x, C) = \int_Y  k(y, C)h(x, d y)$.

Panangaden's definition differs from Giry's in the second clause where subprobability measures are allowed, rather than ordinary probability measures.

Panangaden emphasises that the mechanism is similar to the way that the category of relations can be constructed from the [[power set]] [[functor]]. Just as the category of relations is the [[Kleisli category]] of the powerset functor over the category of sets [[Set]], $SRel$ is the Kleisli category of the functor over the category of [[measurable space]]s and [[measurable function]]s which sends a measurable space, $X$, to the measurable space of sub[[probability measure]]s on $X$. This functor gives rise to a [[monad]].

What is gained by the move from probability measures to subprobability measures? One motivation seems to be to model probabilistic processes from $X$ to a [[coproduct]] $X + Y$. This you can iterate to form a process which looks to see where in $Y$ you eventually end up. This relates to $SRel$ being traced.

There is a [[monad]] on $MeasureSpaces$, $1 + -: Meas \to Meas$. A probability measure on $1 + X$ is a subprobability measure on $X$. Panangaden's monad is a composite of Giry's and $1 + -$.


## Related concepts

* [[monads of probability, measures, and valuations]]

* [[measure]], [[probability measure]], [[pushforward measure]], [[convex mixture]]

* [[measure theory]], [[probability theory]], [[random variable]]

* [[Radon monad]], [[distribution monad]], [[extended probabilistic powerdomain]]

* [[categorical probability]], [[Markov category]]

* [[Markov kernel]], [[Stoch]]


## History

The [[adjoint functor|adjunction]] underlying the Giry monad was originally developed [by Lawvere in 1962](#Lawvere62), prior to the full recognition of the relationship between [[monads]] and [[adjunctions]]. Although P. Huber had already shown in 1961 that every [[adjoint functor|adjoint pair]] gives rise to a [[monad]], it wasn't until 1965 that the constructions of Eilenberg-Moore, and Kleisli, made the essential equivalence of both concepts manifest.  

Lawvere's construction was written up as an [appendix to a proposal](#Lawvere62) to the Arms Control and Disarmament Agency,  set up by President Kennedy as part of the State Department to handle planning and execution of certain treaties with the Soviet Union. This appendix was intended to provide a reasonable framework for arms control verification protocols ([Lawvere 20](#Lawvere20)).

At that time, Lawvere was working for a "think tank" in California, and the purpose of the proposal was to provide a means for verifying compliance with limitations on nuclear weapons.   In the 1980's, [[Michèle Giry]] was collaborating with another French mathematician at that time who was also working with the French intelligence agency, and she was able to obtain a copy of the appendix. Giry then developed and extended some of the ideas in the appendix ([Giry 80](#Giry80))

[[Gian-Carlo Rota]] had also (somehow) obtained a copy of [the appendix](#Lawvere62), which ended up in the library at The American Institute of Mathematics, and only became publicly available in 2012. 

From [Lawvere 20](#Lawvere20):

> I'd like to say that the idea of the category of probabilistic mappings, the document corresponding to that was not part of a seminar, as some of the circulations say, essentially it was the document submitted to the arms control and disarmament agency after suitable checking that the Pentagon didn't disagree with it. Because of the fact that for arms control agencies as a side responsibility the forming of arms control agreements and part of these agreements must involve agreed upon protocols of verification. So the idea of that paper did not provide such protocols, but it purported to provide reasonable framework within which such protocol can be formulated.



## References

The idea originates with

* {#Lawvere62} [[W. Lawvere]], _The category of probabilistic mappings_, ms. 12 pages, 1962  ([[lawvereprobability1962.pdf:file]])

  (notice that the statement of origin on p.1 is wrong)

and was picked up and published in:

* {#Giry80} [[Michèle Giry]], _A categorical approach to probability theory_, Categorical aspects of topology and analysis (Ottawa, Ont., 1980), pp. 68&#8211;85, Lecture Notes in Math. **915** Springer 1982 ([doi:10.1007/BFb0092872](https://doi.org/10.1007/BFb0092872))

  > (there are allegedly a few minor [[analysis|analytically]] incorrect points and gaps in proofs, observed by later authors).

Historical comments on the appearance of [Lawvere 62](#Lawvere62) are made in


* {#Lawvere20} [[Bill Lawvere]], video discussion, 6 June 2020 (in the talk "The algebra of statistical theories and models" by Evan Patterson, at [Categorical Probability and Statistics](http://perimeterinstitute.ca/personal/tfritz/2019/cps_workshop/), 5–8 June 2020, 
([YouTube video, timestamp 1:00:20](http://www.youtube.com/watch?v=BhKaHAY8Ec8&t=60m21s))

According to [E. Burroni (2009)](#Burroni09), the Giry monad appears also in

* O. de la Tullaye, _L'int&#233;gration consid&#233;r&#233;e comme l'alg&#232;bre d'un triple_. Rapport de Stage de D.E.A. manuscrit 1971.

The article

* {#VanBelle21} [[Ruben Van Belle]], *Probability monads as codensity monads*  (2021) $[$[arXiv:2111.01250](https://arxiv.org/abs/2111.01250)$]$ 

shows, in effect, that the Giry monad restricted to countable measurable spaces (with the discrete $\sigma$-algebra) yields the restricted Giry functor $G|: \mathbf{Meas}_c \rightarrow \mathbf{Meas}$ which has the codensity monad $G$.  This suggest that the natural numbers $\mathbb{N}$ are ''sufficient'' in some sense. Indeed, the full subcategory of Polish spaces consisting of the single object $N$ of all natural numbers with the powerset $\sigma$-algebra is codense in $Pol$  - every continuous function $P{X} \rightarrow X$ is completely determined by its values on the countable dense subset of $P{X}$. 

The article  

* [[Kirk Sturtz]], _Categorical Probability Theory_, $[$[arXiv:1406.6030](http://arxiv.org/abs/1406.6030)$]$

views probability measures via double dualization, restricted to weakly averaging affine maps which preserves limits.  A more satisfactory description of probability measures arises from recognizing the need for viewing them as weakly-averaging countably affine maps, obtained by double dualizing into $[0,\infty]$, which then yields the characterization of $G$-algebras summarized [[Giry monad#algebras_over_the_giry_monad|above]], which is from the article

* {#Sturtz25}[[Kirk Sturtz]], _Deriving the Giry algebras on standard Borel spaces using $\mathbb{R}_{\infty}$-generalized points_,  $[$[arXiv:2409.14861](https://arxiv.org/abs/2409.14861)$]$


Some corrections from an earlier version of the Categorical Probability Theory article, were pointed out in

* {#Avery14} [[Tom Avery]], _Codensity and the Giry monad_, Journal of Pure and Applied Algebra **220** 3 (2016) 1229-1251 &lbrack;[arXiv:1410.4432](https://arxiv.org/abs/1410.4432), [doi:10.1016/j.jpaa.2015.08.017](https://doi.org/10.1016/j.jpaa.2015.08.017)&rbrack;

Apart from these papers, there are similar developments in

* Franck van Breugel, _The metric monad for probabilistic nondeterminism_, features both the Lawvere/Giry monad and Panangaden's monad.

* {#Doberkat03} [[Ernst-Erich Doberkat]], _Characterizing the Eilenberg-Moore algebras for a monad of stochastic relations_ ([pdf](https://eldorado.tu-dortmund.de/bitstream/2003/2717/1/147.pdf)) 

* [[Ernst-Erich Doberkat]], _Kleisli morphisms and randomized congruences_, Journal of Pure and Applied Algebra Volume 211, Issue 3, December 2007, Pages 638-664 <https://doi.org/10.1016/j.jpaa.2007.03.003>


* N. N. Cencov, _Statistical decisions rules and optimal Inference_, Translations of Math. Monographs __53__, Amer. Math. Society 1982

(blog comment) Cencov's "category of statistical decisions" coincides with Giry's (Lawvere's) category.  I ($\leftarrow$ somebody) have the sense that Cencov discovered this category independently of Lawvere although years later.

* category cafe related to Giry monad: [category theoretic probability](http://golem.ph.utexas.edu/category/2007/02/category_theoretic_probability.html), [coalgebraic modal logic](http://golem.ph.utexas.edu/category/2009/09/coalgebraic_modal_logic.html) 

* Samson Abramsky et al. _Nuclear and trace ideals in tensored &#8727;-Categories_,[arxiv:math/9805102](http://arxiv.org/abs/math/9805102), on the representation of probability theory through monads, which looks to work Giry's monad into a context even more closely resembling the category of relations. 

There is also relation with work of Jacobs et al. 

* Robert Furber, [[Bart Jacobs]], _Towards a categorical account of conditional probability_, [arxiv:1306.0831](http://arxiv.org/abs/1306.0831)

* [[Bart Jacobs]], _Probabilities, distribution monads and convex categories_, Theoretical
Computer Science 412(28) (2011) pp.3323&#8211;3336. <https://doi.org/10.1016/j.tcs.2011.04.005>, ([preprint](http://www.cs.ru.nl/B.Jacobs/PAPERS/triangle.pdf))

J. Culbertson and K. Sturtz use the Giry monad in their categorical approach to [[Bayesian reasoning]] and inference (both articles contain further references to the categorical approach to probability theory):

* Jared Culbertson and [[Kirk Sturtz]], _A categorical foundation for Bayesian probability_, Applied Cat. Struc. 2013 (preprint as [arXiv:1205.1488](http://arxiv.org/abs/1205.1488))

* Jared Culbertson and [[Kirk Sturtz]], _Bayesian machine learning via category theory_, 2013 ([arxiv:1312.1445](http://arxiv.org/abs/1312.1445)) 

* {#Burroni09} Elisabeth Burroni, _Lois distributives. Applications aux automates stochastiques_, TAC 22, 2009 pp.199-221 ([journal page](http://www.tac.mta.ca/tac/volumes/22/7/22-07abs.html))

where she derives stochastic [[automata]] as algebras for a suitable [[distributive law]]
 on the monoid and Giry monads. 

B. Fong has a section on the Giry monad in his paper on Bayesian networks:

* Fong: _Causal Theories - A Categorical Perspective on Bayesian Networks_, (2013) arXiv:[1301.6201](http://arxiv.org/abs/1301.6201)

See also:

* [Progic posts](http://golem.ph.utexas.edu/category/2007/09/progic.html)



Discussion of the Giry monad extended to [[simplicial sets]] and used to characterize [[quantum contextuality]] via [[simplicial homotopy theory]]:

* {#OkayRobertsBartlettRaussendorf17} [[Cihan Okay]], [[Sam Roberts]], [[Stephen D. Bartlett]], [[Robert Raussendorf]], *Topological proofs of contextuality in quantum mechanics*, Quantum Information and Computation **17** (2017) 1135-1166 &lbrack;[arXiv:1701.01888](https://arxiv.org/abs/1701.01888), [doi:10.26421/QIC17.13-14-5](https://doi.org/10.26421/QIC17.13-14-5)&rbrack;

* {#OkayKharoofIpek22} [[Cihan Okay]], Aziz Kharoof, Selman Ipek, *Simplicial quantum contextuality*, Quantum **7** (2023) 1009 &lbrack;[arXiv:2204.06648](https://arxiv.org/abs/2204.06648), [doi:10.22331/q-2023-05-22-1009](https://doi.org/10.22331/q-2023-05-22-1009)&rbrack;

* Aziz Kharoof, [[Cihan Okay]], *Homotopical characterization of strongly contextual simplicial distributions on cone spaces* &lbrack;[arXiv:2311.14111](https://arxiv.org/abs/2311.14111)&rbrack;

exposition:

* [[Cihan Okay]], *Simplicial Distributions and Contextuality*, [talk at](CQTS#OkayOct2023) [[CQTS]] (11 Oct 2023) &lbrack;video:[YT](https://youtu.be/pgKYGUWl1kU)&rbrack;






category: probability

[[!redirects Giry monad]]
[[!redirects Giry's monad]]
[[!redirects Giry's monad]]
[[!redirects Giry\'s monad]]
[[!redirects Giry's monad]]