
+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
### Context
#### Measure and probability theory
+-- {: .hide}
[[!include measure theory - contents]]
=--
=--
=--


# Contents
* table of contents
{: toc}

## Idea

The _Giry monad_ ([Giry 80](#Giry80), following [Lawvere 62](#Lawvere62)) is the [[monad]] on a [[category]] of suitable [[spaces]] which sends each suitable space $X$ to the space of suitable [[probability measures]] on $X$.

It is one of the main examples of a [[probability monad]], and hence one of the main structures used in [[categorical probability]].


## Definition

The *Giry monad* is defined on the category of [[measurable spaces]], assigning to each measurable space $X$ the space $G(X)$ of all [[probability measures]] on $X$ endowed with the [[sigma-algebra|$\sigma$-algebra]] generated by the set of all the [[evaluation maps]] 
$$
  ev_U \colon G(X) \to [0,1]
$$ 
sending a probability measure $P$ to $P(U)$, where $U$ ranges over all the measurable sets of $X$. The unit of the monad sends a point $x \in X$ to the [[Dirac measure]] at $x$, $\delta_x$, while the [[monad]]-multiplication is defined by the [[natural transformation]] 
$$
  \mu_{X}
  \;\colon\; 
  G\big(G(X)\big) 
  \longrightarrow 
  G(X)
$$

given by

$$
  \mu_X (Q)(U) 
  \;\coloneqq\; 
  \textstyle{\int}_{q \in G(X)} 
  ev_U(q) 
  \,dQ
  \,.
$$

This makes the [[endofunctor]] $G$ into a [[monad]], and as such this is the _Giry monad_ on measurable spaces, as originally defined by [Lawvere 1962](#Lawvere62).

An alternative choice, convenient for analysis purposes, and introduced by Giry, is obtained by restricting the category of [[measurable spaces]] to the (full) subcategory which are those measurable spaces generated by [[Polish spaces]], $Pol$, which are  separable [[metric spaces]] for which a complete metric exists.  The morphisms of this category are continuous functions.

Write 

$$
  P \colon Pol \to Pol
$$

for the [[endofunctor]] which sends a space, $X$, to the space of [[probability measures]] on the [[Borel subsets]] of $X$. $P(X)$ is equipped with the weakest [[topology]] which makes the [[integration]] map $\tau \mapsto \int_{X}f d\tau$ [[continuous function|continuous]] for any $f$, a bounded, continuous, real function on $X$. 

There is a [[natural transformation]] 

$$
  \mu_{X}: P(P(X)) \to P(X)
$$

given by

$$
 \mu_X (M)(A) := \int_{P(X)} \tau(A) M(d\tau).
$$

This makes the [[endofunctor]] $P$ into a [[monad]], and this is the _Giry monad_ on [[Polish spaces]].  

## Properties

### Kleisli category

The [[Kleisli morphisms]] of the Giry monad on [[Meas]] (and related subcategories) are [[Markov kernels]]. Therefore its [[Kleisli category]] is the category [[Stoch]]. 
It is one of the most important examples of a [[Markov category]].

### Algebras over the Giry monad

To analyze algebras, via the Eilenberg-Moore representation, we make use of the fact that, for every measurable space $X$, the space $G(X)$ has the structure of a [[superconvex space]] defined on it pointwise, i.e. if $\sum_{i=1}^n p_i P_i$ is an affine sum of elements of $G(X)$ then the affine sum is also a probability measure in $G(X)$ defined on a measurable set $U$ by $\sum_{i=1}^n p_i P_i(U)$.  Moreover, if we are given a $G$-algebra $h:G(X) \rightarrow X$ then we can also endow the measurable space $X$ with a superconvex space structure defined by $\sum_{i=1}^{\infty} p_i x_i := h(\sum_{i=1}^{\infty} p_i \delta_{x_i})$.

\begin{lemma}
Given any algebra $h:G(X) \rightarrow X$ the map $h$ is a countably affine map.  Moreover, if $k:G(Y) \rightarrow Y$ is another algebra and $f: \langle X, h \rangle \rightarrow \langle Y, k \rangle$ is any morphism of algebras, then $f$ is also countably affine.
\end{lemma}
\begin{proof}
\begin{equation} 
\begin{array}{rcl}
 (h \mu_X)(\sum_{i \in \mathbb{N}} p_i \delta_{P_i}) &=& (h \circ \G(h))(\sum_{i \in \mathbb{N}} p_i \delta_{P_i})   \\
 h(\sum_{i \in \mathbb{N}} p_i P_i) &=& h(\sum_{i \in \mathbb{N}} p_i \delta_{h(P_i)})  \\
 h(\sum_{i \in \mathbb{N}} p_i P_i) &=& \sum_{i \in \mathbb{N}} p_i h(P_i) 
\end{array}.
\end{equation}

 Given the map of $G$-algebras, $f: (X,h) \rightarrow (Y,k)$ it follows that $f$ is a countably affine map because 
\begin{equation} 
\begin{array}{lcl}
f( \sum_{i \in \mathbb{N}} p_i x_i) &=& f(h( \sum_{i \in \mathbb{N}} p_i \delta_{x_i} ))  \\
&=& k\big( G{(f)}( \sum_{i \in \mathbb{N}} p_i \delta_{x_i}  ) \big) \\
&=& k\big(  \sum_{i \in \mathbb{N}} p_i \delta_{f(x_i)} \big) \\
&=&  \sum_{i \in \mathbb{N}} p_i k(\delta_{f(x_i))}  \\
&=&  \sum_{i \in \mathbb{N}} p_i f(x_i) 
\end{array}
\end{equation}
\end{proof}

The utility of this lemma can be seen by the result

\begin{lemma} For the category of Polish spaces (with continuous maps) the Eilenberg-Moore category of algebras is equivalent to the Kleisi category for the Giry monad.  In other words, there are no non-free algebras for the Giry monad on $Pol$.
\end{lemma}
\begin{proof} Recall that, up to isomorphism, the only Polish spaces are the discrete countable spaces and the unit interval.  The fact that there are no non-free algebras for the discrete spaces, as pointed out by  
([Doberkat 03](#Doberkat03)), follows from the fact that the discrete spaces are disconnected, hence there are no continuous functions $G(n) \rightarrow n$, where $n$ is either finite or countable.  So to complete the proof it suffices to show that any algebra $h:G([0,1]) \rightarrow [0,1]$ is necessarily a free algebra.

Thus suppose that $h:G([0,1]) \rightarrow [0,1]$ is an algebra.

The space $[0,1]$ has a countable dense subset $E$ specified by the rational numbers lying in the unit interval, and hence the set $D = \{ \sum_{i=1}^n r_i \delta_{e_i} | r_i,e_i \in E, \sum_{i=1}^n r_i=1\}$ is a dense set in $G([0,1])$. (See Parthasarathy, Probability measures on metric spaces, Theorem 6.3.) Since the set $D$ is dense in $G([0,1])$ and $G([0,1])$ is a complete separable metric space it follows that $h$ is completely determined by its values on the elements of the dense subset $D$, 
\begin{equation}
h(\sum_{i=1}^n r_i \delta_{e_i}) = \sum_{i=1}^n r_i h(\delta_{e_i}) = \sum_{i=1}^n r_i e_i
\end{equation}
where the first equality follows from the preceding Lemma, and the second equality follows from the required condition on an algebra, $h(\delta_e)=e$.  Thus there can exists at most one such algebra, and that algebra $h$ is, up to isomorphism, the function $\mu_{2}: G(G(2)) \rightarrow G(2)$ which is the free algebra on $2$. More explicitly, let $\phi: G(2) \rightarrow [0,1]$ be specified by $(1-t)\delta_0 + t \delta_1 \mapsto t$ have the inverse isomorphism denoted by $\psi$. (That homeomorphism is well known.) Then $h=\phi \circ \mu_2 \circ G{\psi}$ because a direct computation gives
\begin{equation}
\begin{array}{lcl}
\phi(\mu_2(G{\psi}(\sum_{i=1}^n r_i \delta_{e_i}))) &=& \phi(\mu_2(\sum_{i=1}^n r_i \delta_{\psi(e_i)}))\\
&=& \phi(\sum_{i=1}^n r_i \psi(e_i)) \\
&=& \sum_{i=1}^n r_i \phi(\psi(e_i)) \\
&=& \sum_{i=1}^n r_i e_i \\
&=& h(\sum_{i=1}^n r_i \delta_{e_i})
\end{array}
\end{equation} 
where we have made use of the fact that $\phi = ev_{\{1\}}$ is an affine map, as is $\mu_2$. The last line follows from the definition of the superconvex structure on $[0,1]$ 
\end{proof}

We note that in Doberkats [article](http://ls10-www.cs.uni-dortmund.de/index.php?id=18) his representation for the algebras does not indicate whether the algebras are free or non-free. 

The fundamental question concerning algebras is the existence of algebras which are not free.  The Eilenberg-Moore category of algebras, for any monad, is descriptive in nature but not constructive, and says nothing about the existence of algebras which are not free.  For this reason it is often necessary to find a
different representation of the category of $G$-algebras. Although the above negative result concerning no non-free algebras for $Pol$ shows that that the Eilenberg-Moore representation does have its advantages.

 By the fundamental lemma concerning the fact that all algebras are countably affine we are naturally led to the category of [[super convex spaces]], denoted $\mathbf{SCvx}$, which have been referred to as strongly convex spaces in the quantum mechanics literature, e.g., See Mackey - Math. Found. Q.M..  The morphisms of $\mathbf{SCvx}$ are countably affine map (barycenter maps) which generalizes (and is consistent with) the elementary examples of probability monads on compact Hausdorff spaces, etc.. These $G$-algebras, with measurable maps, provide the connection between the continuous (geometric) spaces and discrete (combinatorial) spaces which are necessary for modeling non-determinism.

## Related constructions

See also [[monads of probability, measures, and valuations]].

### Voevodsky's work

[[Vladimir Voevodsky]] has also worked on a category theoretic treatment of [[probability theory]], and gave few talks on this at IHES, Miami, in Moscow etc. Voevodsky had in mind applications in [[mathematical biology]], for example, population genetics: 

See [Miami Talk abstract](http://www.math.miami.edu/anno/voevodsky.htm)

> ...a categorical study of probability theory where "categorical" is understood in the sense of category theory. Originally, I developed this approach to probability to get a better understanding of the constructions which I had to deal with in population genetics. Later it evolved into something which seems to be also interesting from a purely mathematical point of view. On the elementary level it gives a category which is useful for the work with probabilistic constructions involving complicated combinations of stochastic processes of different types. On a more advanced level, applying in this context the old idea of a functor as a generalized object one gets a better view of the relationship between probability and the theory of (pre-)ordered topological vector spaces. 

A talk in Moscow (20 Niv 2008, in Russian) can be viewed [here](http://www.mi.ras.ru/index.php?c=obs_sem/&l=1), [wmv 223.6 Mb](http://www.mi.ras.ru/media/335_full.wmv). Abstract:

> In early 60-ies Bill Lawvere defined a category whose objects are measurable spaces and morphisms are Markov kernels. I will try to show how this category allows one to think about many of the notions of probability theory in categorical terms and to connect probabilistic objects to objects of other types through various functors.

Voevodsky's unfinished [notes on categorical probability theory](http://www.math.ias.edu/Voevodsky/voevodsky-publications_abstracts.html#markov) have been released posthumously.

### Panangaden's monad

[[Prakash Panangaden]] in [Probabilistic Relations](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.52.4840) defines the [[category]] $SRel$ (stochastic [[relation]]s) to have as [[object]]s [[set]]s equipped with a $\sigma$[[sigma-field|-field]]. [[morphism|Morphisms]] are conditional probability densities or stochastic kernels. So, a morphism from $( X, \Sigma_X)$ to $( Y, \Sigma_Y)$ is a function $h: X \times \Sigma_Y \to [0, 1]$ such that 

1. $\forall B \in \Sigma_Y . \lambda x \in X . h(x, B)$ is a bounded measurable function,
1. $\forall x \in X . \lambda B \in \Sigma_Y . h(x, B)$ is a subprobability measure on $\Sigma_Y$.

If $k$ is a morphism from $Y$ to $Z$, then $k \cdot h$ from $X$ to $Z$ is defined as $(k \cdot h)(x, C) = \int_Y  k(y, C)h(x, d y)$.

Panangaden's definition differs from Giry's in the second clause where subprobability measures are allowed, rather than ordinary probability measures.

Panangaden emphasises that the mechanism is similar to the way that the category of relations can be constructed from the [[power set]] [[functor]]. Just as the category of relations is the [[Kleisli category]] of the powerset functor over the category of sets [[Set]], $SRel$ is the Kleisli category of the functor over the category of [[measurable space]]s and [[measurable function]]s which sends a measurable space, $X$, to the measurable space of sub[[probability measure]]s on $X$. This functor gives rise to a [[monad]].

What is gained by the move from probability measures to subprobability measures? One motivation seems to be to model probabilistic processes from $X$ to a [[coproduct]] $X + Y$. This you can iterate to form a process which looks to see where in $Y$ you eventually end up. This relates to $SRel$ being traced.

There is a [[monad]] on $MeasureSpaces$, $1 + -: Meas \to Meas$. A probability measure on $1 + X$ is a subprobability measure on $X$. Panangaden's monad is a composite of Giry's and $1 + -$.


## Related concepts

* [[monads of probability, measures, and valuations]]

* [[measure]], [[probability measure]], [[pushforward measure]], [[convex mixture]]

* [[measure theory]], [[probability theory]], [[random variable]]

* [[Radon monad]], [[distribution monad]], [[extended probabilistic powerdomain]]

* [[categorical probability]], [[Markov category]]

* [[Markov kernel]], [[Stoch]]


## History

The [[adjoint functor|adjunction]] underlying the Giry monad was originally developed [by Lawvere in 1962](#Lawvere62), prior to the full recognition of the relationship between [[monads]] and [[adjunctions]]. Although P. Huber had already shown in 1961 that every [[adjoint functor|adjoint pair]] gives rise to a [[monad]], it wasn't until 1965 that the constructions of Eilenberg-Moore, and Kleisli, made the essential equivalence of both concepts manifest.  

Lawvere's construction was written up as an [appendix to a proposal](#Lawvere62) to the Arms Control and Disarmament Agency,  set up by President Kennedy as part of the State Department to handle planning and execution of certain treaties with the Soviet Union. This appendix was intended to provide a reasonable framework for arms control verification protocols ([Lawvere 20](#Lawvere20)).

At that time, Lawvere was working for a "think tank" in California, and the purpose of the proposal was to provide a means for verifying compliance with limitations on nuclear weapons.   In the 1980's, [[Michèle Giry]] was collaborating with another French mathematician at that time who was also working with the French intelligence agency, and was able to obtain a copy of the appendix. Giry then developed and extended some of the ideas in the appendix ([Giry 80](#Giry80))

[[Gian-Carlo Rota]] had also (somehow) obtained a copy of [the appendix](#Lawvere62), which ended up in the library at The American Institute of Mathematics, and only became publicly available in 2012. 

From [Lawvere 20](#Lawvere20):

> I'd like to say that the idea of the category of probabilistic mappings, the document corresponding to that was not part of a seminar, as some of the circulations say, essentially it was the document submitted to the arms control and disarmament agency after suitable checking that the Pentagon didn't disagree with it. Because of the fact that for arms control agencies as a side responsibility the forming of arms control agreements and part of these agreements must involve agreed upon protocols of verification. So the idea of that paper did not provide such protocols, but it purported to provide reasonable framework within which such protocol can be formulated.



## References

The idea originates with

* {#Lawvere62} [[W. Lawvere]], _The category of probabilistic mappings_, ms. 12 pages, 1962  ([[lawvereprobability1962.pdf:file]])

  (notice that the statement of origin on p.1 is wrong)

and was picked up and published in:

* {#Giry80} [[Michèle Giry]], _A categorical approach to probability theory_, Categorical aspects of topology and analysis (Ottawa, Ont., 1980), pp. 68&#8211;85, Lecture Notes in Math. **915** Springer 1982 ([doi:10.1007/BFb0092872](https://doi.org/10.1007/BFb0092872))

  > (there are allegedly a few minor [[analysis|analytically]] incorrect points and gaps in proofs, observed by later authors).

Historical comments on the appearance of [Lawvere 62](#Lawvere62) are made in


* {#Lawvere20} [[Bill Lawvere]], video discussion, 6 June 2020 (in the talk "The algebra of statistical theories and models" by Evan Patterson, at [Categorical Probability and Statistics](http://perimeterinstitute.ca/personal/tfritz/2019/cps_workshop/), 5–8 June 2020, 
([YouTube video, timestamp 1:00:20](http://www.youtube.com/watch?v=BhKaHAY8Ec8&t=60m21s))

According to [E. Burroni (2009)](#Burroni09), the Giry monad appears also in

* O. de la Tullaye, _L'int&#233;gration consid&#233;r&#233;e comme l'alg&#232;bre d'un triple_. Rapport de Stage de D.E.A. manuscrit 1971.

The article

* {#VanBelle21} [[Ruben Van Belle]], *Probability monads as codensity monads*  (2021) $[$[arXiv:2111.01250](https://arxiv.org/abs/2111.01250)$]$ 

shows, in effect, that the Giry monad restricted to countable measurable spaces (with the discrete $\sigma$-algebra) yields the restricted Giry functor $G|: \mathbf{Meas}_c \rightarrow \mathbf{Meas}$ which has the codensity monad $G$.  This suggest that the natural numbers $\mathbb{N}$ are ''sufficient'' in some sense. Indeed, the full subcategory of Polish spaces consisting of the single object $N$ of all natural numbers with the powerset $\sigma$-algebra is codense in $Pol$ for the reasons delineated in the proof above - every function $X \rightarrow N$ is completely determined by its values on the dense subset of $X$. The proof of that can be found in 
* {#Sturtz22} [[Kirk Sturtz]], _Giry algebras for standard measurable spaces_ $[$[arXiv:2202:10819](https://arxiv.org/abs/2202.10819)$]$

with the caveat that standard measurable spaces should be replaced by Polish spaces. Recognition of that error led to the above proof that for Polish spaces no non-free algebras exists. 
That article has evolved from 
the preliminary work 

* [[Kirk Sturtz]], _Categorical Probability Theory_, $[$[arXiv:1406.6030](http://arxiv.org/abs/1406.6030)$]$

which views probability measures via double dualization, restricted to weakly averaging affine maps which preserves limits.  (A more satisfactory description of probability measures arises from recognizing the need for viewing them as weakly-averaging countably affine maps, rather than just finite affine maps, as discussed in that article.)

Some corrections from an earlier version of the article, were pointed out in

* {#Avery14} [[Tom Avery]], _Codensity and the Giry monad_, Journal of Pure and Applied Algebra **220** 3 (2016) 1229-1251 &lbrack;[arXiv:1410.4432](https://arxiv.org/abs/1410.4432), [doi:10.1016/j.jpaa.2015.08.017](https://doi.org/10.1016/j.jpaa.2015.08.017)&rbrack;

Apart from these papers, there are similar developments in

* Franck van Breugel, _The metric monad for probabilistic nondeterminism_, features both the Lawvere/Giry monad and Panangaden's monad.

* {#Doberkat03} [[Ernst-Erich Doberkat]], _Characterizing the Eilenberg-Moore algebras for a monad of stochastic relations_ ([pdf](https://eldorado.tu-dortmund.de/bitstream/2003/2717/1/147.pdf)) 

* [[Ernst-Erich Doberkat]], _Kleisli morphisms and randomized congruences_, Journal of Pure and Applied Algebra Volume 211, Issue 3, December 2007, Pages 638-664 <https://doi.org/10.1016/j.jpaa.2007.03.003>


* N. N. Cencov, _Statistical decisions rules and optimal Inference_, Translations of Math. Monographs __53__, Amer. Math. Society 1982

(blog comment) Cencov's "category of statistical decisions" coincides with Giry's (Lawvere's) category.  I ($\leftarrow$ somebody) have the sense that Cencov discovered this category independently of Lawvere although years later.

* category cafe related to Giry monad: [category theoretic probability](http://golem.ph.utexas.edu/category/2007/02/category_theoretic_probability.html), [coalgebraic modal logic](http://golem.ph.utexas.edu/category/2009/09/coalgebraic_modal_logic.html) 

* Samson Abramsky et al. _Nuclear and trace ideals in tensored &#8727;-Categories_,[arxiv:math/9805102](http://arxiv.org/abs/math/9805102), on the representation of probability theory through monads, which looks to work Giry's monad into a context even more closely resembling the category of relations. 

There is also relation with work of Jacobs et al. 

* Robert Furber, [[Bart Jacobs]], _Towards a categorical account of conditional probability_, [arxiv:1306.0831](http://arxiv.org/abs/1306.0831)

* [[Bart Jacobs]], _Probabilities, distribution monads and convex categories_, Theoretical
Computer Science 412(28) (2011) pp.3323&#8211;3336. <https://doi.org/10.1016/j.tcs.2011.04.005>, ([preprint](http://www.cs.ru.nl/B.Jacobs/PAPERS/triangle.pdf))

J. Culbertson and K. Sturtz use the Giry monad in their categorical approach to [[Bayesian reasoning]] and inference (both articles contain further references to the categorical approach to probability theory):

* Jared Culbertson and [[Kirk Sturtz]], _A categorical foundation for Bayesian probability_, Applied Cat. Struc. 2013 (preprint as [arXiv:1205.1488](http://arxiv.org/abs/1205.1488))

* Jared Culbertson and [[Kirk Sturtz]], _Bayesian machine learning via category theory_, 2013 ([arxiv:1312.1445](http://arxiv.org/abs/1312.1445)) 

* {#Burroni09} Elisabeth Burroni, _Lois distributives. Applications aux automates stochastiques_, TAC 22, 2009 pp.199-221 ([journal page](http://www.tac.mta.ca/tac/volumes/22/7/22-07abs.html))

where she derives stochastic [[automata]] as algebras for a suitable [[distributive law]]
 on the monoid and Giry monads. 

B. Fong has a section on the Giry monad in his paper on Bayesian networks:

* Fong: _Causal Theories - A Categorical Perspective on Bayesian Networks_, (2013) arXiv:[1301.6201](http://arxiv.org/abs/1301.6201)

See also:

* [Progic posts](http://golem.ph.utexas.edu/category/2007/09/progic.html)



Discussion of the Giry monad extended to [[simplicial sets]] and used to characterize [[quantum contextuality]] via [[simplicial homotopy theory]]:

* {#OkayRobertsBartlettRaussendorf17} [[Cihan Okay]], [[Sam Roberts]], [[Stephen D. Bartlett]], [[Robert Raussendorf]], *Topological proofs of contextuality in quantum mechanics*, Quantum Information and Computation **17** (2017) 1135-1166 &lbrack;[arXiv:1701.01888](https://arxiv.org/abs/1701.01888), [doi:10.26421/QIC17.13-14-5](https://doi.org/10.26421/QIC17.13-14-5)&rbrack;

* {#OkayKharoofIpek22} [[Cihan Okay]], Aziz Kharoof, Selman Ipek, *Simplicial quantum contextuality*, Quantum **7** (2023) 1009 &lbrack;[arXiv:2204.06648](https://arxiv.org/abs/2204.06648), [doi:10.22331/q-2023-05-22-1009](https://doi.org/10.22331/q-2023-05-22-1009)&rbrack;

* Aziz Kharoof, [[Cihan Okay]], *Homotopical characterization of strongly contextual simplicial distributions on cone spaces* &lbrack;[arXiv:2311.14111](https://arxiv.org/abs/2311.14111)&rbrack;

exposition:

* [[Cihan Okay]], *Simplicial Distributions and Contextuality*, [talk at](CQTS#OkayOct2023) [[CQTS]] (11 Oct 2023) &lbrack;video:[YT](https://youtu.be/pgKYGUWl1kU)&rbrack;






category: probability

[[!redirects Giry monad]]
[[!redirects Giry's monad]]
[[!redirects Giry's monad]]
[[!redirects Giry\'s monad]]
[[!redirects Giry's monad]]