
+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
###Context###
#### Geometry
+--{: .hide}
[[!include higher geometry - contents]]
=--
#### Cohomology
+--{: .hide}
[[!include cohomology - contents]]
=--
#### Duality
+-- {: .hide}
[[!include duality - contents]]
=--
=--
=--


#Contents#
* table of contents
{:toc}

## Idea

A _Wirthmüller context_ is a pair of two [[symmetric monoidal category|symmetric]] [[closed monoidal categories]] $(\mathcal{X}, \otimes_X, 1_{X})$, $(\mathcal{Y}, \otimes_Y, 1_Y)$ which are connected by an [[adjoint triple]] of [[functors]] such that the middle one is a [[closed monoidal functor]].

This is the variant/special case of the [[yoga of six operations]] consisting of two [[adjoint pairs]] $(f_! \dashv f^!)$ and $(f^\ast \dashv f_\ast)$ and the [[tensor product]]/[[internal hom]] [[adjunctions]] $((-)\otimes B \dashv [B,-])$,  specialized to the case that  $f^! \simeq f^\ast$:

$$
  f_! \dashv (f^! = f^\ast) \dashv f_\ast
  \;\colon\;
  \mathcal{X}
    \stackrel{\overset{f_!}{\longrightarrow}}{\stackrel{\overset{f^! = f^\ast }{\leftarrow}}{\underset{f_\ast}{\longrightarrow}}}
  \mathcal{Y}
  \,.
$$

(The other specialization of the [[six operations]] to $f_\ast \simeq f_!$ is called the _[[Grothendieck context]]_).

Often one is interested in the case that there is an [[object]] $C \in \mathcal{X}$ and an [[equivalence]]

$$
  f_\ast 1_{X} \simeq f_! C
  \,.
$$

If this induces a [[natural equivalence]]

$$
  f_\ast A  \simeq f_!(A \otimes_X C)
$$

for $A \in \mathcal{X}$, then one says this is a _Wirthmüller isomorphism_, following ([Wirthmueller 74](#Wirthmueller74)).
In particular there is a canonical [[natural transformation]] 

$$
  f_\ast A  \longrightarrow f_!(A \otimes_X C)
$$

and one can ask this to be an equivalence, hence a Wirthmüller isomorphism ([May 05](#May05)).


## Definition

+-- {: .num_defn #WirthmullerContext}
###### Defininition

Let $(\mathcal{X}, \otimes_X, 1_{X})$, $(\mathcal{Y}, \otimes_Y, 1_Y)$ be two [[symmetric monoidal category|symmetric]] [[closed monoidal categories]] and let 

$$
  f_! \dashv (f^! = f^\ast) \dashv f_\ast
  \;\colon\;
  \mathcal{X}
    \stackrel{\overset{f_!}{\longrightarrow}}{\stackrel{\overset{f^! = f^\ast }{\leftarrow}}{\underset{f_\ast}{\longrightarrow}}}
  \mathcal{Y}
$$

be an [[adjoint triple]] of [[functors]] between them. We call this setup

* a _pre-Wirthmüller context_ if $f^\ast$ is a [[strong monoidal functor]]:

* a _Wirthmüller context_ if $f^\ast$ is in addition a [[strong closed functor]], hence a strongly [[closed monoidal functor]].

=--

([May 05, def. 2.12](#May05))


+-- {: .num_defn }
###### Definition (Notation)

We write $[-,-]$ for the [[internal hom]] functors. For $A \in \mathcal{X}$ we write

$$
  \mathbb{D}A \coloneqq [A,1_X]
$$

for the [[internal hom]] from $A$ into the [[unit object]], hence for dual of $A$ with respect to the [[closed category]] structure, its [[dual object in a closed category]]. 

We say "$A$ is dualizable" to mean that it is a [[dualizable object]] with respect, insead, to the (symmetric) [[monoidal category]] structure $\otimes_X$. If $A$ is dualizable we write $A^\vee$ for its monoidal [[dual object]].

Similarly for $B \in \mathcal{Y}$.

=--

+-- {: .num_remark }
###### Remark

If all objects in $\mathcal{X}$ and $\mathcal{Y}$ are [[dualizable object|dualizable]], hence if they are [[compact closed categories]], then they are in particular also [[star-autonomous categories]] with [[dualizing object]] the [[tensor unit]]. As such their [[internal logic]] is _[[linear logic]]_ and their [[type theory]] is _[[linear type theory]]_. In terms of this a Wirthmüller morphism, def. \ref{WirthmullerContext}, is the linear analog of a [[context extension]] morphism in a [[hyperdoctrine]]: it defines a _[[dependent linear type theory]]_. See there for more.

=--

## Properties
 {#Properties}

### The comparison maps

+-- {: .num_remark #QuasiMonoidalnessOfLeftAdjoint}
###### Remark

In a pre-Wirthmüller context, def. \ref{WirthmullerContext}, 
there is a canonical [[natural transformation]]

$$
  f_!(A \otimes_X B)
    \longrightarrow
  (f_! A) \otimes_Y (f_! B)
  \,,
$$

(not necessarily an [[equivalence]]) being the [[adjunct]] of the composite

$$
  A \otimes_X B
  \stackrel{}{\longrightarrow}
  (f^\ast f_! A) \otimes_X (f^\ast f_! B)
  \stackrel{\simeq}{\longrightarrow}
  f^\ast ( (f_! A) \otimes_Y (f_! B) )
  \,,
$$

where the first morphism is the [[tensor product]] of two copies of the
[[unit of an adjunction|adjunction unit]] and where the second
is the [[equivalence]] that exhibits $f^\ast$ as a [[strong monoidal functor]].


=--

+-- {: .num_defn #ComparisonMaps}
###### Defininition

In a pre-Wirthmüller context, def. \ref{WirthmullerContext},
write $\overline {\pi}$ for the [[natural transformation]]

$$
  \overline{\pi}
  \;\colon\;
  f_! ((f^\ast B) \otimes A) 
  \longrightarrow 
  B \otimes f_! A
$$

given as the composite

$$
  \overline{\pi}
  \;\colon\;
  f_! ((f^\ast B) \otimes A) 
   \stackrel{}{\longrightarrow}
  (f_! f^\ast B) \otimes_Y (f_! A)
   \longrightarrow 
  B \otimes f_! A
  \,,
$$

where the first morphism is that of remark \ref{QuasiMonoidalnessOfLeftAdjoint} and where the second 
is the $(f_! \dashv f^\ast)$ [[counit of an adjunction|counit]] (tensored with an identity).

Also write

$$
  \overline{\gamma}
    \;\colon\;
  [f_! A, B]
   \longrightarrow
  f_\ast [A, f^\ast B]
$$

for the $(f^\ast \dashv f_\ast)$ [[adjunct]] of the [[natural transformation]] given as the composite

$$
  f^\ast [f_! A, B]
   \stackrel{\simeq}{\longrightarrow}
  [f^\ast f_! A, \, f^\ast B]
   \longrightarrow
  [A, f^\ast B]  
  \,,
$$

where the first map exhibits $f^\ast$ as a [[closed monoidal functor]] and where the second is the $(f_! \dashv f^\ast)$-[[unit of an adjunction|unit]] (under the [[internal hom]]).

=--

see ([May 05, prop. 2.11](#May05))

+-- {: .num_prop #ComparisonIsEquivalenceOnDualizables}
###### Proposition

In a pre-Wirthmüller context, def. \ref{WirthmullerContext}, the comparison maps of def. \ref{ComparisonMaps} are [[equivalences]]
when the argument $B \in (\mathcal{Y}, \otimes_Y, 1_Y)$ is a [[dualizable object]].

If either of the two happens to be a [[natural equivalence]] (hence an equivalence for all arguments), then so is the other.

=--

([May 05, prop. 2.8 and prop. 2.11](#May05))

+-- {: .num_prop #InWirthmuellerContextProjectionIsEquivalence}
###### Proposition

Precisely if the pre-Wirthmüller context is a Wirthmüller context, def. \ref{WirthmullerContext}, are both comparison maps of def. \ref{ComparisonMaps} are natural equivalences.

=--

+-- {: .proof}
###### Proof

For all $A \in \mathcal{X}$ and $B,C \in \mathcal{Y}$ we have
by the $(f_! \dashv f^\ast)$-[[adjunction]] and the
tensor$\dashv$hom-adjunction a [[commuting diagram]] of the form


$$
  \array{
    \mathcal{Y}(f_! ((f^\ast B) \otimes A),\, C)
     &
      \stackrel{
        \mathcal{Y}(\overline{\pi}(A,B), C)
      }{
        \longrightarrow
     }
     &
    \mathcal{Y}(B \otimes f_! A, \, C  )
    \\
    \downarrow^{\mathrlap{\simeq}}
     &&
    \downarrow^{\mathrlap{\simeq}}
    \\
    \mathcal{X}(A, [(f^\ast B), (f^\ast C)])
    &\stackrel{}{\longrightarrow}&
    \mathcal{X}(A, f^\ast [B,C])
  }
  \,.
$$

By naturality in $A$ and by the [[Yoneda lemma]] this shows
that $\overline{\pi}$ is an equivalence precisey if 
$f^\ast$ is strong closed.

For $\overline{\gamma}$ the same statement follows from this with 
prop. \ref{ComparisonIsEquivalenceOnDualizables}.

=--


+-- {: .num_remark }
###### Remark

The first [[natural equivalence]] of prop. \ref{InWirthmuellerContextProjectionIsEquivalence} 

$$
  f_!(f^\ast A \otimes B) \simeq A \otimes f_!(B)
$$

is often called the *[[projection formula]]*. In [[representation theory]] this is also sometimes called *[[Frobenius reciprocity]]*, though mostly that term is used for (just) the existence of the $(f_! \dashv f^\ast)$-[[adjunction]], where in representation theory the [[left adjoint]] $f_!$ forms [[induced representations]].

=--


### Comparison of push-forwards and Wirthmüller isomorphism

+-- {: .num_cor #PushforwardsIntertwinedByDuality}
###### Corollary

In a pre-Wirthmüller context, def. \ref{WirthmullerContext}, the functors $f_!$ and $f_\ast$ are intertwined by dualization, in that there is a [[natural equivalence]]

$$
  \mathbb{D}(f_! A) \simeq f_\ast(\mathbb{D} A)
  \,.
$$

=--

+-- {: .proof}
###### Proof

This is the special case of the property of $\overline{\gamma}$ in  prop. \ref{ComparisonIsEquivalenceOnDualizables}  for $B = 1_Y$:

$$
  \mathbb{D}(f_! A)
  =  
  [f_! A, 1_Y]
   \underoverset{\simeq}{\overline{\gamma}}{\longrightarrow}
  f_\ast [A, f^\ast 1_Y]
  \simeq
  f_\ast [A, 1_Y]
  =
  f_\ast \mathbb{D} A
  \,.
$$

=--

+-- {: .num_example}
###### Example

In a pre-Wirthmüller context

$$
  f_\ast 1_X \simeq \mathbb{D}(f_! 1_X)
  \,.
$$

=--

+-- {: .proof}
###### Proof

By cor. \ref{PushforwardsIntertwinedByDuality}, 
since $\mathbb{D} 1_X \simeq 1_X$.

=--


+-- {: .num_prop #AbstractWirthmuellerIso}
###### Proposition
**(Wirthmüller isomorphism)**

In a Wirthmüller context, def. \ref{WirthmullerContext} if $f_! 1_X$ is a [[dualizable object]] with dual $f_! C$, then there is a [[natural equivalence]]

$$
  \omega
   \;\colon\;
  f_\ast f^\ast A \stackrel{\simeq}{\longrightarrow} f_!((f^\ast A) \otimes C)
  \,.
$$

=--

([May 05, prop. 4.13](#May05)).


+-- {: .num_remark #MonadCommutesWithDualityUpTotwist}
###### Remark

In particular if there is $D \in \mathcal{Y}$ with

$$
  \mathbb{D}(f_! f^\ast 1_Y) \simeq f_! f^\ast D
$$


(hence if $C \simeq f^\ast D$ in the notation of prop. \ref{AbstractWirthmuellerIso}) and using that by cor. \ref{PushforwardsIntertwinedByDuality},
$
  f_\ast f^\ast  \mathbb{D}B
  \simeq
  f_\ast \mathbb{D} f^\ast B
  \simeq
  \mathbb{D}(f_! f^\ast B)$
then prop. \ref{AbstractWirthmuellerIso} gives a natural equivalence of the form

$$
  \mathbb{D}(f_! f^\ast B)
    \stackrel{\simeq}{\longrightarrow}
   f_! f^\ast ((\mathbb{D}B) \otimes D)
  \,,
$$

saying that the [[comonad]] $f_! f^\ast$ commutes with dualization up to a "twist" given by tensoring with $D$.

=--




## Examples

### Cartesian Wirthmüller contexts in toposes

For $\mathbf{H}$ a [[topos]] and $f \colon X \longrightarrow Y$
any [[morphism]], then in the induced [[base change]] [[etale geometric morphism]]

$$
  (\sum_f \dashv f^\ast \dashv \prod_f)
  \;\colon\;
  \mathbf{H}_{/X}
  \longrightarrow
  \mathbf{H}_{/Y}
$$

the [[inverse image]]/[[context extension]] is a [[cartesian closed functor]] (see there for the proof). Therefore any base change of [[toposes]] constitutes a cartesian Wirthmüller context.

Concersely, this means that systems of Wirthmüller contexts are generalizations of [[categorical logic]] ([[hyperdoctrines]]) to non-cartesian contexts (see at _[[dependent linear type theory]]_). 

Notice that in a cartesian Wirthmüller context duality is trivial, in that $\mathbb{D}X \simeq 1$ for all objects $X$. Therefore to the extent that the [[six operations]] yoga involves duality, it is interesting only the more non-cartesian (non-classical) the ambient Wirthmüller context is.

### Bundles of modules

For $R$ a [[ring]], $R Mod$ its [[category of modules]], there is a [[functor]]

$$
  [-, R Mod] \;\colon\; Set^{op} \longrightarrow ClMonCat
$$

which sends a [[set]] $X$ to the [[closed monoidal category]] of $R$-[[modules]] parameterized over $X$. 

This takes values in Wirthmüller morphisms. ([Shulman 12, example 2.2, 2.17](#Shulman12)).


 
### In equivariant stable  homotopy theory

In [[equivariant stable homotopy theory]], see ([May 05b](#May05b)).

### In $E_\infty$-geometry

In [[E-∞ geometry]], left adjoints

$$
  f_! \;\colon\; QCoh(X) \longrightarrow QCoh(Y)
$$

to the canonical [[inverse image]] map along a morphism $f \;\colon\; X \longrightarrow Y$ of [[E-∞ geometry|E-∞ algebraic spaces]] is discussed in ([Lurie, prop. 3.3.23](#Lurie)).


The existence of [[dualizing modules]] $K$

$$
  D X = [X,K]
$$ 

is discussed in ([[Representability theorems|Lurie, Representability theorems, section 4.2]].)

## Related concepts

* [[Verdier-Grothendieck context]]

* [[Grothendieck context]]

* [[Beck-Chevalley condition]]

## References

The construction goes back to and is named after

* Klaus Wirthmüller, _Equivariant homology and duality_. Manuscripta Math. 11(1974), 373-390
 {#Wirthmueller74}

A clear discussion of axioms of [[six operations]] and their consequences, with emphasis on the Wirthmüller isomorphisms, is in 

* H. Fausk, P. Hu, [[Peter May]],  _Isomorphisms between left and right adjoints_, Theory and Applications of Categories , Vol. 11, 2003, No. 4, pp 107-131. ([TAC](http://www.tac.mta.ca/tac/volumes/11/4/11-04abs.html), [pdf](http://www.math.uiuc.edu/K-theory/0573/FormalFeb16.pdf))
 {#May05}

Discussion of the Wirthmüller isomorphism in [[equivariant stable homotopy theory]], based on this, is in

* [[Peter May]], _The Wirthmüller isomorphism revisited_ ([pdf](http://www.math.uiuc.edu/K-theory/0574/WirthRev.pdf))
 {#May05b}

More elaboration of the Wirthmüller context is in 

* Baptiste Calmès, Jens Hornbostel, section 4 of _Tensor-triangulated categories and dualities_, Theory and Applications of Categories, Vol. 22, 2009, No. 6, pp 136-198 ([TAC](http://www.tac.mta.ca/tac/volumes/22/6/22-06abs.html), [arXiv:0806.0569](http://arxiv.org/abs/0806.0569))

Wirthmüller morphisms between bundles of modules is discussed (implicitly) in 


* [[Mike Shulman]], _Enriched indexed categories_ ([arXiv:1212.3914](http://arxiv.org/abs/1212.3914))
 {#Shulman12}


Discussion in [[E-∞ geometry]] is in


* [[Jacob Lurie]], section 3.3. of _[[Proper Morphisms, Completions, and the Grothendieck Existence Theorem]]_
 {#Lurie}

* [[Jacob Lurie]], section 4.2 of _[[Representability theorems]]_


[[!redirects Wirthmüller contexts]]

[[!redirects Wirthmueller context]]
[[!redirects Wirthmueller contexts]]

[[!redirects Wirthmuller context]]
[[!redirects Wirthmuller contexts]]


[[!redirects Wirthmüller isomorphism]]
[[!redirects Wirthmüller isomorphisms]]

[[!redirects Wirthmueller isomorphism]]
[[!redirects Wirthmueller isomorphisms]]

[[!redirects Wirthmuller isomorphism]]
[[!redirects Wirthmuller isomorphisms]]

