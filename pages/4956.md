+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
### Context
#### Differential geometry
+-- {: .hide}
[[!include synthetic differential geometry - contents]]
=--
=--
=--

# Contents
* table of contents
{: toc}

## Idea

_Differentiation_ of a [[function]] $f : X \to Y$ is the process that assigns to each point $x \in X$ _[[differences]]_ $f(y) - f(x)$ between the value $f(x)$ of the function at that point, and its value at all [[infinitesimal space|infinitesimally]] nearby points $y$. This collection of information is called the _derivative_ $d f$ of the function.


## Definition

_Differentiation_ is the [[functor]] $d : Diff \to Diff$ on the [[category]] [[Diff]] of [[smooth manifold]]s that sends

* a manifold $X$ to its [[tangent bundle]] $T X$;

* a [[smooth function]] $f : X \to Y$ to its differential $d f : T X \to T Y$:

  if $\gamma : [-1,1] \to X$ is a path in $X$ that represents a vector $v \in T_x X$, then $(d f)(v) \in T_{f(x)} Y$ is the vector represented by the path
  $[-1,1] \stackrel{\gamma}{\to} X \stackrel{f}{\to} Y$. 

In a context $H$ of [[synthetic differential geometry]] the functor $d$ is simply the [[internal hom]] out of the [[infinitesimal space|infinitesimal interval]] $D$

$$
  d = [D, -] : H \to H
  \,.
$$

## Functoriality 

The functoriality of differentiation is immediate from the above definition. The property that differentiation is functorial is known in the literature as the [[chain rule]].


## Exposition of differentiation via infinitesimals
 {#ExpositionDifferentiationViaInfinitesimal}


We attempt to give an exposition of differentiation not via taking limits in the sense of [[analysis]], but rather, by working with [[infinitesimal space]]s as in [[synthetic differential geometry]].

### Setup

For that purpose we regard objects such as the [[real line]] $\mathbb{R}$ and more generally any [[smooth manifold]] as being objects of a [[Models for Smooth Infinitesimal Analysis|well adapted]] [[smooth topos]] of [[smooth space]]s. But in fact much less is required for most of the discussion. For the basic theory, it is sufficient to work in the canonical [[site]] of such a topos, namely, the category $SmoothLoc$ of [[smooth loci]]. This site is defined via a categorial equivalence with the [[opposite category]] of the category of [[smooth algebra]]s:

$$
  C^\infty: SmoothLoc \stackrel{\sim}{\longrightarrow} SmoothAlg^{op}
$$


Apart from the real line $\mathbb{R}$, the other object involved in our discussion of the basics of differentiation is the first order [[infinitesimal space|infinitesimal line segment]] $D$ (an [[infinitesimally thickened point]]), a [[subobject]] of $\mathbb{R}$. This subobject collects those points of $\mathbb{R}$ that square to zero under the canonical multiplicative structure of $\mathbb{R}$

$$
  D = \{\epsilon \in \mathbb{R} | \epsilon^2 = 0\}
  \,.
$$

Although this is just $\{0\}$ when interpreted in the usual context of [[Set]], here we are to interpret this in the ambient [[smooth topos]], or equivalently just in our [[site]] $SmoothLoc$ for it. That is to say, $D$ satisfies a [[pullback]] square in $SmoothLoc$:

$$
  \array{
    D &\to& *
    \\
    \downarrow && \downarrow^{\mathrlap{0}}
    \\
    \mathbb{R} &\stackrel{(-)^2}{\to}& \mathbb{R}
  }
$$

Dually, the categorial equivalence $C^\infty$ from $SmoothLoc$ to the [[opposite category]] of [[smooth algebra]]s carries the above pullback square to a [[pushout]] square of [[smooth algebras]]:

$$
  \array{
     C^\infty(D) &\leftarrow& C^\infty(*) \simeq \mathbb{R}
     \\
     \uparrow && \uparrow^{\mathrlap{f \mapsto f(0)}}
     \\
     C^\infty(\mathbb{R}) 
      &\stackrel{x \mapsto x^2}{\leftarrow}& 
     C^\infty(\mathbb{R})
  }
$$

Here along the bottom and on the right are the ordinary smooth algebras of [[smooth function]]s on the [[smooth manifold]]s $\mathbb{R}^1 = \mathbb{R}$ and $\mathbb{R}^0 = *$, whereas $C^\infty(D)$ is new notation, suggestive and justified, for whatever the algebra of functions on the object $D$ is, where $D$ is _defined_ by the fact that it has this algebra of functions. The bottom morphism sends a smooth function $f : \mathbb{R} \to \mathbb{R}$ to the function $f((-)^2) : \mathbb{R} \to \mathbb{R}$. If we write $x = Id : \mathbb{R} \to \mathbb{R}$ for the canonical [[coordinate]] function, then this sends $x$ to the function $x^2$.  

Notice that the commutativity of this pushout square means that the image in $C^\infty(D)$ of the squared coordinate function $x^2 \in C^\infty(\mathbb{R})$  is zero. This is  because the former is the image under the bottom morphism of the coordinate function $x$ and that maps under the right vertical morphism to $0 \in C^\infty(*) \simeq \mathbb{R}$.

In fact one can show that the [[pushout]] $C^\infty(D)$ is _generated_ by the coordinate function $x \in C^\infty(\mathbb{R}))$ subject to the relation $x^2 = 0$: it is the [[ring of dual numbers]]

$$
  \begin{aligned}
    C^\infty(D) & \simeq C^\infty(\mathbb{R})/(x^2) 
    \\
    & \simeq \mathbb{R}[x]/(x^2)
  \end{aligned}
  \,.
$$

(Here in the second step we have used [[Hadamard's lemma]].)

This computation of the smooth algebra $C^\infty(D)$ of smooth functions on $D$ expresses the intuitive idea that $D$ is such a small neighbourhood of $0$ in $\mathbb{R}$ that while the canonical coordinate function of $\mathbb{R}$ restricted to $D$ is non-vanishing (it would vanish only when restricted entirely to the point 0) it is "so small that its square is always 0". Readers who like this intuitive statement should keep it in mind, as it is accurate and useful, whereas readers who do not like it could stick with the above precise definition, which unwinds this slogan in the [[internal logic]] of the ambient [[smooth topos]] that we keep alluding to.

In order to remind us about the infinitesimal nature of the generator $x$ in $C^\infty(D)$ we shall usually call this "$dx$" and write

$$
  C^\infty(D) = \mathbb{R}[dx]/((dx)^2) \simeq \mathbb{R} \oplus dx \mathbb{R}
  \,.
$$

### Functions and differential 1-forms
 {#FunctionsAndForms}

We discussion of [[differential 1-forms]] are functions on the space of infinitesimal paths. For more comprehensive such discussion see ([Stel 13](#Stel13)).

Define the [[smooth locus]] $\mathbb{R}^{(\Delta^1_{inf})}$ as the [[product]] $\mathbb{R} \times D$ of the [[real line]] with the first order [[infinitesimal space|infinitesimal line segment]].
We think of this as the space of **infinitesimal paths** in $\mathbb{R}$ (see <a href="http://nlab.mathforge.org/nlab/show/infinitesimal%20object#SpacOfInfSimpl">Spaces of infinitesimal k-simplicies</a> ). We do so by thinking of a [[generalized element]] of $\mathbb{R}^{(\Delta^1_{inf})}$ in the category $SmoothLoc$, namely a pair $(x, \epsilon) \in \mathbb{R} \times D$, as the linear path in $\mathbb{R}$ stretching from $x$ to $x + \epsilon$ (both regarded as [[generalized element]]s of $\mathbb{R}$).

We say a **smooth [[differential form|differential 1-form]]** on $\mathbb{R}$ is a function (meaning: a [[morphism]] in $SmoothLoc$)

$$
  \omega : 
  X^{(\Delta^1_{inf})} \to \mathbb{R}
$$

with the property that its restriction to $\mathbb{R}$ vanishes, hence so that the composite morphism

$$
 0 : \mathbb{R} \hookrightarrow X^{(\Delta^1_{inf})} \stackrel{\omega}{\to} \mathbb{R}
$$

vanishes, where the first morphism is the inclusion of $\mathbb{R}$ as the constant infinitesimal paths in $\mathbb{R}$, hence $(Id, 0) : \mathbb{R} \to \mathbb{R} \times D$.


We call the [[coproduct]] of [[smooth algebra]]s their [[tensor product]] (classically it is the _smoothly completed_ algebraic tensor product). For each smooth loci $X$ and $Y$, we have 

$$
  C^\infty(X \times Y) \simeq C^\infty(X) \otimes C^\infty(Y)
  \,.
$$

Using this property, we can dualize the above definition of a diferential 1-form. Namely, in the [[opposite category]] of [[smooth algebra]]s, a 1-form on the line is a morphism

$$
  C^\infty(\mathbb{R}) \otimes \mathbb{R}[dx]/((dx)^2)
   \leftarrow
  C^\infty(\mathbb{R})
  : 
  \omega^*
  \,,
$$

hence an assignment $ x \mapsto g(x) +  h(x) dx $ such that $g(x) = 0$. In other words, it is any element in $C^\infty(\mathrm{R}) \otimes \mathbb{R}[dx]/((dx)^2)$ that is proportional to the generator $dx$. We write $ \omega = h dx $ with $h \in C^\infty(\mathbb{R})$.

### Derivatives as infinitesimal differences

We can now "[[synthetic differential geometry|synthetically]]" describe differentiation as the process of taking infinitesimal differences of functions.

Consider the two morphisms of smooth loci

$$
  + : \mathbb{R}^{(\Delta^1_{inf})} = \mathbb{R} \times D \to \mathbb{R}
$$

and

$$
  p_1 : \mathbb{R}^{(\Delta^1_{inf})} = \mathbb{R} \times D \to \mathbb{R}
  \,,
$$

where the first is the restriction of the canonical addition operation $+ : \mathbb{R} \times \mathbb{R} \to \mathbb{R}$ of [[real number]]s, and where the second is the [[projection]] on the first factor out of the [[product]].

Given an element $f \in C^\infty(\mathbb{R})$, hence a [[smooth function]] $f : \mathbb{R} \to \mathbb{R}$, we can then form two functions on infinitesimal paths by precomposing with these two morphisms:

first we get

$$
 f : X^{(\Delta^1_{inf})} \stackrel{p_1}{\to} \mathbb{R}
   \stackrel{f}{\to} \mathbb{R}
  \,.
$$

This is the function on infinitesimal paths in the line that only depends on the starting point of a path, not on the length of the path, and which sends that starting point to the value of $f$ on that point. Therefore by slight abuse of notation we just keep writing "$f$" for this function.

The second combination is

$$
 \tilde f : X^{(\Delta^1_{inf})} \stackrel{+}{\to} \mathbb{R}
   \stackrel{f}{\to} \mathbb{R}
  \,.
$$

This is the function on infinitesimal paths that sends any path $(x) \to (x + \epsilon)$ to the value of the function on the _endpoint_ $(x + \epsilon)$ of the paths: in terms of these [[generalized element]]s $\tilde f$ is the assignment

$$
  \tilde f : (x , \epsilon) \mapsto f(x + \epsilon)
 \,.
$$

For instance consider the function $f : x \mapsto x^2$. Then 

$$
  \begin{aligned}
   \tilde f : (x, \epsilon) &\mapsto (x + \epsilon)^2
    \\ 
    & = x^2  + 2 x \epsilon + \epsilon^2 
    \\
    & = x^2 + 2 x \epsilon 
   \end{aligned}
   \,.
$$

This is evident, if maybe still somewhat mysterious, in the internal language of the ambient [[smooth topos]] that we keep alluding to, but to make it entirely explicit and concrete notice that the functions here are dually morphisms of smooth algebras

$$
  C^\infty(\mathbb{R}) \otimes (\mathbb{R} \oplus dx \mathbb{R})
  \leftarrow
  C^\infty(\mathbb{R})
  : 
  (\tilde f)^* 
$$

and the equation

$$
  (x + dx)^2 = x^2 + 2 x dx 
$$

holds in $C^\infty(\mathbb{R}) \otimes (\mathbb{R} \oplus dx \mathbb{R})$ by the [above discussion](FunctionsAndForms), where now $x \in C^\infty(\mathbb{R})$ and $dx \in C^\infty(D) = \mathbb{R} \oplus dx \mathbb{R}$ are the two canonical generators.

But notice that the expression $x^2 + 2 x dx $ is not a dfifferential 1-form by the above definition, equivalently the function $\tilde f$ does not vanish when restricted to constant infinitesimal paths.

To get such, we form the **[[derivative]]** or **infinitesimal difference**, the function

$$
  \tilde f - f : X^{(\Delta^1_{inf})} \to \mathbb{R}
$$

that acts on [[generalized element]]s of the space of infinitesimal paths in the line as

$$
  (\tilde f - f) : (x, \epsilon) \mapsto 
   f(x + \epsilon) - f(x)
  \,.
$$

By construction on the right this now is something linear in the infinitesimal length $\epsilon$ of the path. Write $f' \in C^\infty(\mathbb{R})$ for the coefficient:

$$
  f(x + \epsilon) - f(x) = \epsilon f'(x)
  \,.
$$

This function $f'$ is the **[[differential]]** of $f$. It is the function that gives the change of the function $f$ along a "unit infinitesimal path".

Dually, we have a morphism

$$
  C^\infty(\mathbb{R})\otimes (\mathbb{R} \oplus dx \mathbb{R})
  \leftarrow
  C^\infty(\mathbb{R})
  :
  (\tilde f - f)^*
$$

that sends

$$
  x \mapsto f(x + dx) - f(x) = f'(x) dx
  \,.
$$

The 1-form on the right is the [[de Rham differential]] of $f$, usually written

$$
  (d f)(x) = f'(x) dx \in C^\infty(\mathbb{R} \times D)
  \,.
$$ 

### As a map of tangent bundles
 {#InfinitesimalDifferentiationAsAMapOfTangentBundles}

Equivalently we may rephrase this differential $d f$ as a morphism of [[tangent bundles]] $d f \colon T \mathbb{R} \longrightarrow T \mathbb{R}$ as follows.

First, by the [[Kock-Lawvere axiom]] of SDG we have the standard fact that $T \mathbb{R} := \mathbb{R}^D \simeq \mathbb{R} \times \mathbb{R}$. Therefore given a function

$$
  \mathbb{R} \times D \longrightarrow \mathbb{R}
$$

this is by the [[internal hom]]-[[adjunction]] equivalently a function of the form

$$
  \mathbb{R} \longrightarrow \mathbb{R}^D = T \mathbb{R}
  \,.
$$

The condition on the original function makes this [[adjunct]] be a [[section]] of the [[tangent bundle]] of $\mathbb{R}$. This section is $x \mapsto f'(x)$, hence is the derivative of $f$ regarded as a [[tangent vector]] on $\mathbb{R}$. Moreover, since $\mathbb{R}$ is a [[microlinear space]], this induces by rescaling a function

$$
   T \mathbb{R} = \mathbb{R} \times \mathbb{R} \longrightarrow T \mathbb{R}
  \,.
$$

This is the differential of $f$ regarded as a map of tangent bundles.


## Related concepts

* [[product law]], [[chain rule]]

* [[Jacobian matrix]], [[Hessian matrix]], [[extremum]]

* [[partial differentiation]]

* [[Hadamard lemma]], [[Fermat theory]]

* [[pullback of differential forms]]

* [[tangent space]], [[tangent bundle]]

* [[jet space]], [[jet bundle]], [[metric jet]]



## References

Discussion of differential forms as functions on infinitesimal simplices is in 

* [[Herman Stel]], _Cosimplicial $C^\infty$ rings and the de Rham complex of Euclidean space_ ([arXiv:1310.7407](http://arxiv.org/abs/1310.7407))
 {#Stel13}

[[!include infinitesimal and local - table]]


[[!redirects differentiation]]
[[!redirects derivative]]
[[!redirects derivatives]]