
+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
### Context
#### Measure and probability theory
+-- {: .hide}
[[!include measure theory - contents]]
=--
=--
=--


# Contents
* table of contents
{: toc}

## Idea

The _Giry monad_ ([Giry 80](#Giry80), following [Lawvere 62](#Lawvere62)) is the [[monad]] on a [[category]] of suitable [[spaces]] which sends each suitable space $X$ to the space of suitable [[probability measures]] on $X$.


## Definition

The Giry monad is defined on the category of [[measurable spaces]], assigning to each measurable space $X$ the space of all probability measures on $X$, $G(X)$, endowed with the $\sigma$-algebra generated by the set of all the evaluation maps 
$$
ev_U \colon G(X) \to [0,1]
$$ 
sending a probability measure $P$ to $P(U)$, where $U$ ranges over all the measurable sets of $X$. The unit of the monad sends a point $x \in X$ to the [[Dirac measure]] at $x$, $\delta_x$, while the multiplication of the monad is defined by the natural transformation 
$$
  \mu_{X}: G(G(X)) \to G(X)
$$

given by

$$
 \mu_X (Q)(U) := \int_{q \in G(X)} ev_U(q) dQ.
$$
This makes the [[endofunctor]] $G$ into a [[monad]], and this is the _Giry monad_  on Measurable spaces, as originally given by Lawvere.

An alternative choice, convenient for analysis purposes, and introduced by Giry, is obtained by restricting the category of [[measurable spaces]] to the (full) subcategory which are those measurable spaces generated by [[Polish spaces]], $Pol$, which are  separable [[metric spaces]] for which a complete metric exists.  

Write 

$$
  P \colon Pol \to Pol
$$

for the [[endofunctor]] which sends a space, $X$, to the space of [[probability measures]] on the [[Borel subsets]] of $X$. $P(X)$ is equipped with the weakest [[topology]] which makes the [[integration]] map $\tau \mapsto \int_{X}f d\tau$ [[continuous function|continuous]] for any $f$, a bounded, continuous, real function on $X$. 

There is a [[natural transformation]] 

$$
  \mu_{X}: P(P(X)) \to P(X)
$$

given by

$$
 \mu_X (M)(A) := \int_{P(X)} \tau(A) M(d\tau).
$$

This makes the [[endofunctor]] $P$ into a [[monad]], and this is the _Giry monad_ on [[Polish spaces]].  The shortcoming of restricting the Giry monad to Polish spaces is that discrete spaces have no $P$-algebras (even though they do have $G$-algebras).  For example, take the discrete (measurable) space $2$, which we can also view as a topological discrete space.  The measurable map $\epsilon_{2}: G(2) \to 2$ defined by $\epsilon_{2}( (1-\alpha) \delta_0 + \alpha \delta_1) = 0$ for all $\alpha \in [0,1)$, and by $\epsilon_{2}(\delta_1)=1$ shows that $(2,\epsilon_2)$ is a $G$-algebra, yet it is not a $P$-algebra. (As Doberkat has noted,  a $P$-algebra must be connected, but that is impossible for discrete spaces.)  The map $\epsilon_{2}$ plays a critical role in the analysis of the $G$-algebras, because it is the unique affine map from the geometric (convex) space $G(2)$, which is isomorphic to the unit interval $[0,1]$ with its natural convex structure, to the discrete (combinatorial) convex space $2$. 

## Properties

### Algebras over the Giry monad

([Doberkat 03](#Doberkat03)) works out the [[algebra over a monad|algebras]] for the Giry monad using the Giry monad defined on $Pol$. We want measurable maps between $P(X)$ and $X$, such that the 'fibres' are convex and closed, and such that $\delta_{x}$, the delta distribution on $x$, is in the fibre over $x$. And there's another condition which requires a compact subset of $P(X)$ to be sent to a compact subset of $X$.

Now, as ever, $P(X)$ will support an algebra, $\mu_{X}: P(P(X)) \to P(X)$. This is the analogue of a [[free construction|free]] [[group]] being an algebra of the group monad. But just as there are many interesting groups which are not free, we should want to find algebras of Giry's monad which are not of the $\mu_{X}$ form. Doberkat shows that for such an algebra $X$ must be connected, and suggests this example

$$
h: P([0, 1]) \ni \tau \mapsto \int_{0}^{1} t \tau (dt) \in [0, 1].
$$

(One author believes that this might be $\mu_{\{0, 1\}}$. After all, probability measures on $\{0, 1\}$ are just binomial, parameterised by $p \in [0, 1]$.)

The other example he gives has $X$ a bounded, closed and convex subset of $\mathbb{R}^n$, and probability measures being sent to their barycentre. 

Doberkat has a longer article on [[Eilenberg-Moore algebra]]s of the Giry monad as item 5 [here](http://ls10-www.cs.uni-dortmund.de/index.php?id=18). (Unfortunately, the monograph 'Stochastic Relations: Foundations for Markov Transition Systems' doesn't appear to be available.) There are two monads being treated here, one which sends a Polish space to the space of all probability measures, the other to the space of all subprobability measures. The extra structure relating to these monads, is that of a (positive) convex structure. In the case of a convex structure, this intuitively captures the idea that a weighted sum of points in the space has barycentre within the space. 

Doberkat focused on the Giry monad on the category of Polish spaces. A further question is, what is a concrete characterization of the Giry monad on the category of measurable spaces? This is being investigated in ongoing work by Sturtz (e.g. [Sturtz 19](#Sturtz)) who is attempting to factor the monad through the category of super convex space (which have been referred to as strongly convex spaces in the quantum mechanics literature, e.g., See Mackey - Math. Found. Q.M.). See the discussion page at nforum for details. 

## Related constructions

See also [[monads of probability, measures, and valuations]].

### Voevodsky's work

[[Vladimir Voevodsky]] has also worked on a category theoretic treatment of [[probability theory]], and gave few talks on this at IHES, Miami, in Moscow etc. Voevodsky had in mind applications in [[mathematical biology]], for example, population genetics: 

See [Miami Talk abstract](http://www.math.miami.edu/anno/voevodsky.htm)

> ...a categorical study of probability theory where "categorical" is understood in the sense of category theory. Originally, I developed this approach to probability to get a better understanding of the constructions which I had to deal with in population genetics. Later it evolved into something which seems to be also interesting from a purely mathematical point of view. On the elementary level it gives a category which is useful for the work with probabilistic constructions involving complicated combinations of stochastic processes of different types. On a more advanced level, applying in this context the old idea of a functor as a generalized object one gets a better view of the relationship between probability and the theory of (pre-)ordered topological vector spaces. 

A talk in Moscow (20 Niv 2008, in Russian) can be viewed [here](http://www.mi.ras.ru/index.php?c=obs_sem/&l=1), [wmv 223.6 Mb](http://www.mi.ras.ru/media/335_full.wmv). Abstract:

> In early 60-ies Bill Lawvere defined a category whose objects are measurable spaces and morphisms are Markov kernels. I will try to show how this category allows one to think about many of the notions of probability theory in categorical terms and to connect probabilistic objects to objects of other types through various functors.

Voevodsky's unfinished [notes on categorical probability theory](http://www.math.ias.edu/Voevodsky/voevodsky-publications_abstracts.html#markov) have been released posthumously.

### Panangaden's monad

[[Prakash Panangaden]] in [Probabilistic Relations](http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.52.4840) defines the [[category]] $SRel$ (stochastic [[relation]]s) to have as [[object]]s [[set]]s equipped with a $\sigma$[[sigma-field|-field]]. [[morphism|Morphisms]] are conditional probability densities or stochastic kernels. So, a morphism from $( X, \Sigma_X)$ to $( Y, \Sigma_Y)$ is a function $h: X \times \Sigma_Y \to [0, 1]$ such that 

1. $\forall B \in \Sigma_Y . \lambda x \in X . h(x, B)$ is a bounded measurable function,
1. $\forall x \in X . \lambda B \in \Sigma_Y . h(x, B)$ is a subprobability measure on $\Sigma_Y$.

If $k$ is a morphism from $Y$ to $Z$, then $k \cdot h$ from $X$ to $Z$ is defined as $(k \cdot h)(x, C) = \int_Y  k(y, C)h(x, d y)$.

Panangaden's definition differs from Giry's in the second clause where subprobability measures are allowed, rather than ordinary probability measures.

Panangaden emphasises that the mechanism is similar to the way that the category of relations can be constructed from the [[power set]] [[functor]]. Just as the category of relations is the [[Kleisli category]] of the powerset functor over the category of sets [[Set]], $SRel$ is the Kleisli category of the functor over the category of [[measurable space]]s and [[measurable function]]s which sends a measurable space, $X$, to the measurable space of sub[[probability measure]]s on $X$. This functor gives rise to a [[monad]].

What is gained by the move from probability measures to subprobability measures? One motivation seems to be to model probabilistic processes from $X$ to a [[coproduct]] $X + Y$. This you can iterate to form a process which looks to see where in $Y$ you eventually end up. This relates to $SRel$ being traced.

There is a [[monad]] on $MeasureSpaces$, $1 + -: Meas \to Meas$. A probability measure on $1 + X$ is a subprobability measure on $X$. Panangaden's monad is a composite of Giry's and $1 + -$.


## Related concepts

* [[monads of probability, measures, and valuations]]

* [[measure]], [[probability measure]], [[pushforward measure]]

* [[measure theory]], [[probability theory]], [[random variable]]

* [[Radon monad]], [[distribution monad]], [[probabilistic powerdomain]], [[extended probabilistic powerdomain]]


## History

The [[adjoint functor|adjunction]] underlying the Giry monad was originally developed [by Lawvere in 1962](#Lawvere62), prior to the full recognition of the relationship between [[monads]] and [[adjunctions]]. Although P. Huber had already shown in 1961 that every [[adjoint functor|adjoint pair]] gives rise to a [[monad]], it wasn't until 1965 that the constructions of Eilenberg-Moore, and Kleisli, made the essential equivalence of both concepts manifest.  

Lawvere's construction was written up as an [appendix to a proposal](#Lawvere62) to the Arms Control and Disarmament Agency,  set up by President Kennedy as part of the State Department to handle planning and execution of certain treaties with the Soviet Union. This appendix was intended to provide a reasonable framework for arms control verification protocols ([Lawvere 20](#Lawvere20)).

At that time, Lawvere was working for a "think tank" in California, and the purpose of the proposal was to provide a means for verifying compliance with limitations on nuclear weapons.   In the 1980's, [[Michèle Giry]] was collaborating with another French mathematician at that time who was also working with the French intelligence agency, and was able to obtain a copy of the appendix. Giry then developed and extended some of the ideas in the appendix ([Giry 80](#Giry80))

[[Gian-Carlo Rota]] had also (somehow) obtained a copy of [the appendix](#Lawvere62), which ended up in the library at The American Institute of Mathematics, and only became publicly available in 2012. 

From [Lawvere 20](#Lawvere20):

> I'd like to say that the idea of the category of probabilistic mappings, the document corresponding to that was not part of a seminar, as some of the circulations say, essentially it was the document submitted to the arms control and disarmament agency after suitable checking that the Pentagon didn't disagree with it. Because of the fact that for arms control agencies as a side responsibility the forming of arms control agreements and part of these agreements must involve agreed upon protocols of verification. So the idea of that paper did not provide such protocols, but it purported to provide reasonable framework within which such protocol can be formulated.



## References

The idea originates with

* {#Lawvere62} [[W. Lawvere]], _The category of probabilistic mappings_, ms. 12 pages, 1962  ([[lawvereprobability1962.pdf:file]])

  (notice that the statement of origin on p.1 is wrong)

and was picked up and published in:

* {#Giry80} [[Michèle Giry]], _A categorical approach to probability theory_, Categorical aspects of topology and analysis (Ottawa, Ont., 1980), pp. 68&#8211;85, Lecture Notes in Math. **915** Springer 1982 ([doi:10.1007/BFb0092872](https://doi.org/10.1007/BFb0092872))

  (there are allegedly a few minor [[analysis|analytically]] incorrect points and gaps in proofs, observed by later authors).

Historical comments on the appearance of [Lawvere 62](#Lawvere62) are made in


* {#Lawvere20} [[Bill Lawvere]], video discussion, 6 June 2020 (in the talk "The algebra of statistical theories and models" by Evan Patterson, at [Categorical Probability and Statistics](http://perimeterinstitute.ca/personal/tfritz/2019/cps_workshop/), 5–8 June 2020, 
([YouTube video, timestamp 1:00:20](http://www.youtube.com/watch?v=BhKaHAY8Ec8&t=60m21s))

According to [E. Burroni (2009)](#Burroni09), the Giry monad appears also in

* O. de la Tullaye, _L'int&#233;gration consid&#233;r&#233;e comme l'alg&#232;bre d'un triple_. Rapport de Stage de D.E.A. manuscrit 1971.

The factorization of the Giry monad, defined on the category of measurable spaces, through the category of super convex spaces, is described in

* {#Sturtz19} [[Kirk Sturtz]], _The equivalence of the categories of Giry-algebras and super convex spaces_, [arXiv:1907.03209](http://arxiv.org/abs/1907.03209)

which generalize the preliminary work 

* K. Sturtz, _Categorical Probability Theory_, [arXiv:1406.6030](http://arxiv.org/abs/1406.6030)

which views probability measures via double dualization, restricted to weakly averaging affine maps which preserves limits.   The preservation of limits (of countable affine sums) is automatic in the category of super convex spaces, and necessary for the factorization.

That article includes some corrections from an earlier version of the article, pointed out in

* T. Avery, _Codensity and the Giry monad_, arXiv:[1410.4432](http://arxiv.org/abs/1410.4432) (2014).

Apart from these papers, there are similar developments in

* Franck van Breugel, _The metric monad for probabilistic nondeterminism_, features both the Lawvere/Giry monad and Panangaden's monad.

* {#Doberkat03} [[Ernst-Erich Doberkat]], _Characterizing the Eilenberg-Moore algebras for a monad of stochastic relations_ ([pdf](https://eldorado.tu-dortmund.de/bitstream/2003/2717/1/147.pdf)) 

* [[Ernst-Erich Doberkat]], _Kleisli morphisms and randomized congruences_, Journal of Pure and Applied Algebra Volume 211, Issue 3, December 2007, Pages 638-664 <https://doi.org/10.1016/j.jpaa.2007.03.003>


* N. N. Cencov, _Statistical decisions rules and optimal Inference_, Translations of Math. Monographs __53__, Amer. Math. Society 1982

(blog comment) Cencov's "category of statistical decisions" coincides with Giry's (Lawvere's) category.  I ($\leftarrow$ somebody) have the sense that Cencov discovered this category independently of Lawvere although years later.

* category cafe related to Giry monad: [category theoretic probability](http://golem.ph.utexas.edu/category/2007/02/category_theoretic_probability.html), [coalgebraic modal logic](http://golem.ph.utexas.edu/category/2009/09/coalgebraic_modal_logic.html) 

* Samson Abramsky et al. _Nuclear and trace ideals in tensored &#8727;-Categories_,[arxiv:math/9805102](http://arxiv.org/abs/math/9805102), on the representation of probability theory through monads, which looks to work Giry's monad into a context even more closely resembling the category of relations. 

There is also relation with work of Jacobs et al. 

* Robert Furber, [[Bart Jacobs]], _Towards a categorical account of conditional probability_, [arxiv:1306.0831](http://arxiv.org/abs/1306.0831)

* [[Bart Jacobs]], _Probabilities, distribution monads and convex categories_, Theoretical
Computer Science 412(28) (2011) pp.3323&#8211;3336. <https://doi.org/10.1016/j.tcs.2011.04.005>, ([preprint](http://www.cs.ru.nl/B.Jacobs/PAPERS/triangle.pdf))

J. Culbertson and K. Sturtz use the Giry monad in their categorical approach to [[Bayesian reasoning]] and inference (both articles contain further references to the categorical approach to probability theory):

* Jared Culbertson and Kirk Sturtz, _A categorical foundation for Bayesian probability_, Applied Cat. Struc. 2013 (preprint as [arXiv:1205.1488](http://arxiv.org/abs/1205.1488))

* Jared Culbertson and Kirk Sturtz, _Bayesian machine learning via category theory_, 2013 ([arxiv:1312.1445](http://arxiv.org/abs/1312.1445)) 

* {#Burroni09} Elisabeth Burroni, _Lois distributives. Applications aux automates stochastiques_, TAC 22, 2009 pp.199-221 ([journal page](http://www.tac.mta.ca/tac/volumes/22/7/22-07abs.html))

where she derives stochastic [[automata]] as algebras for a suitable [[distributive law]]
 on the monoid and Giry monads. 

B. Fong has a section on the Giry monad in his paper on Bayesian networks:

* Fong: _Causal Theories - A Categorical Perspective on Bayesian Networks_, (2013) arXiv:[1301.6201](http://arxiv.org/abs/1301.6201)

To do:

* Bring in material from [Progic posts](http://golem.ph.utexas.edu/category/2007/09/progic.html)





[[!redirects Giry monad]]
[[!redirects Giry's monad]]
[[!redirects Giry's monad]]
[[!redirects Giry\'s monad]]
[[!redirects Giry's monad]]