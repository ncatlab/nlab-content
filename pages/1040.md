
+-- {: .rightHandSide}
+-- {: .toc .clickDown tabindex="0"}
###Context###
#### Algebra
+--{: .hide}
[[!include higher algebra - contents]]
=--
#### 2-Category theory
+--{: .hide}
[[!include 2-category theory - contents]]
=--
=--
=--


# Idempotent monads
* table of contents
{: toc}

## Definition 

An __idempotent monad__  is a [[monad]] $(T,\mu,\eta)$ on a category $C$ such that one (hence all) of the following equivalent statements are true:

1. $\mu\colon T T \to T$ is a [[natural transformation|natural isomorphism]]. 

2. All components of $\mu\colon T T \to T$ are monic.

3. The maps $T\eta, \eta T\colon T \to T T$ are equal. 

4. For every $T$-algebra ($T$-module)
$(M,u)$, the corresponding $T$-action $u\colon T M \to M$ is an isomorphism.

5. The forgetful functor $C^T \to C$ (where $C^T$ is the [[Eilenberg-Moore category]] of $T$-algebras) is a [[full and faithful functor]].

6. There exists an adjunction $F\dashv U$ such that the induced monad $(FU, F\epsilon U)$ is isomorphic to $(T,\mu)$ and $U$ is fully faithful. 

+-- {: .proof}
###### Proof of equivalence (in more than one way).

$1\Rightarrow 2$ is trivial.

$2\Rightarrow 3$ Compositions $\mu\circ T\eta$ and $\mu\circ\eta T$ are always the identity (unit axioms for the monad), and in particular agree; if $\mu$ has all components monic, this implies $T\eta = \eta T$. 

$3\Rightarrow 4$ Compatibility of action and unit is $u \circ \eta_M = id_M$, hence also $T(u)\circ T(\eta_M) = id_{T M}$. If $T\eta = \eta T$ then this 
implies $id_M = T(u)\circ \eta_{T M} = \eta_M\circ U$, where the naturality of $\eta$ is used in the second equality. Therefore we exhibited $\eta_M$ both as a left and a right inverse of $u$. 

$4\Rightarrow 1$ If every action is iso, then the components of multiplication $\mu_M\colon T T M\to T M$ are isos as a special case, namely of the free action on $T M$. 

$4\Rightarrow 5$ For any monad $T$, the forgetful functor from Eilenberg-Moore category $C^T$ to $C$ is faithful: a morphism of $T$-algebras is always a morphism of underlying objects in $C$. To show that it is also full, we consider any pair $(M,u)$, $(M',u')$ in $C^T$ 
and must show that any $f\colon M\to M'$ is actually 
a map $f\colon (M,u)\to (M',u')$; i.e. $u'\circ T f = f\circ u$. But we know that $\eta_M, \eta_{M'}$ are inverses of $u,u'$ respectively and 
the naturality for $\eta$ says $\eta_{M'}\circ f = T f \circ \eta_M$. Compose that equation with $u$ on the right and $u'$ on the left with the result (notice that we used just the invertibility of $u$).  

$5\Rightarrow 6$ Trivial, because the Eilenberg-Moore construction induces the original monad by the standard recipe. 

$6\Rightarrow 3$ By $6$ the counit $\epsilon$ is iso, hence $U\epsilon F$ has a unique 2-sided inverse; by triangle identities, $T\eta$ and $\eta T$ are both right inverses of $U\epsilon F$, hence 2-sided inverses, hence they are equal.

$6\Rightarrow 1$ If $F\dashv U$ is an adjunction with $U$ fully faithful, 
then the counit $\epsilon$ is iso. The induced monad has multiplication 
$\mu = U\epsilon F$ hence iso; every isomorphic monad is also iso.
=--

Part 5 means that in such a case $C^T$ is, up to equivalence a full [[reflective subcategory]] of $C$.  Conversely, the monad induced by any reflective subcategory is idempotent, so giving an idempotent monad on $C$ is equivalent to giving a reflective subcategory of $C$.

In the language of [[stuff, structure, property]], an idempotent monad may be said to equip its algebras with _properties only_ (since $C^T\to C$ is fully faithful), unlike an arbitrary monad, which equips its algebras with _at most structure_ (since $C^T\to C$ is, in general, faithful but not full).

If $T$ is idempotent, then it follows in particular that an object of $C$ admits at most one structure of $T$-algebra, that this happens precisely when the  unit $\eta_X\colon X\to T X$ is an isomorphism, and in this case the $T$-algebra structure map is $\eta_X^{-1}\colon T X \to X$.  However, it is possible to have a non-idempotent monad for which any object of $C$ admits at most one structure of $T$-algebra, in which case $T$ can be said to equip objects of $C$ with [[property-like structure]]; an easy example is the monad on [[semigroups]] whose algebras are [[monoids]].


## Algebras of an idempotent monad 

+-- {: .un_thm}
###### Proposition

Let $(M, \eta, \mu)$ be an idempotent monad on a category $E$. The following conditions on an object $e$ of $E$ are equivalent: 

1. The object $e$ carries an $M$-algebra structure. 

2. The unit $\eta e\colon e \to M e$ is a split monomorphism. 

3. The unit $\eta e$ is an isomorphism. 

(It follows from 3. that there is at most one algebra structure on $e$, given by $\xi = (\eta e)^{-1}\colon M e \to e$.) 
=-- 

+-- {: .proof} 
###### Proof 
The implication 1. $\Rightarrow$ 2. is immediate. Next, if $\xi\colon M e \to e$ is any retraction of $\eta e$, we have both $\xi \circ \eta e = 1_e$ and 
$$\array{
\eta e \circ \xi & = & (M \xi)(\eta M e) & & \text{naturality of}\, \eta \\
 & = & (M \xi)(M \eta e) & & \text{see definitions above} \\
 & = & M(\xi \circ \eta e) & & \text{functoriality} \\
 & = & 1_{M e} & & 
}$$
so 2. implies 3. Finally, if $\eta e$ is an isomorphism, put $\xi = (\eta e)^{-1}$. Then $\xi \circ \eta e = 1_e$ (unit condition), and the associativity condition for $\xi$, 

$$\xi \circ \mu e = \xi \circ M \xi,$$

follows by inverting the naturality equation $\eta M e \circ \eta e = M \eta e \circ \eta e$. Thus 3. implies 1. 
=-- 


## The associated idempotent monad of a monad

+-- {: .un_thm}
###### Theorem (Fakir) 
Let $C$ be a complete, well-powered category, and let $M\colon C \to C$ be a monad with unit $u\colon 1 \to M$ and multiplication $m\colon M M \to M$. Then there is a universal idempotent monad, giving a right adjoint to 

$$IdempotentMonad(C) \hookrightarrow Monad(C)$$ 
=-- 

+-- {: .proof} 
###### Proof
Given a monad $M$, define a functor $M'$ as the equalizer of $M u$ and $u M$:  

$$M' \hookrightarrow M \stackrel{\overset{u M}{\to}}{\underset{M u}{\to}} M M.$$ 

This $M'$ acquires a monad structure. It might not be an idempotent monad (although it will be if $M$ is left exact). However we can apply the process again, and continue transfinitely. Define $M_0 = M$, and if $M_\alpha$ has been defined, put $M_{\alpha+1} = M_{\alpha}'$; at limit ordinals $\beta$, define $M_\beta$ to be the inverse limit of the chain 

$$\ldots \hookrightarrow M_{\alpha} \hookrightarrow \ldots \hookrightarrow M$$

where $\alpha$ ranges over ordinals less than $\beta$. This defines the monad $M_\alpha$ inductively; below, we let $u_\alpha$ denote the unit of this monad. 

Since $C$ is well-powered (i.e., since each object has only a small number of subobjects), the large limit 

$$E(M)(c) = \underset{\alpha \in Ord}{\lim} M_\alpha(c)$$ 

exists for each $c$. Hence the large limit $E(M) = \underset{\alpha \in Ord}{\lim} M_\alpha$ exists as an endofunctor. The underlying functor 

$$Monad(C) \to Endo(C)$$ 

reflects limits (irrespective of size), so $E = E(M)$ acquires a monad structure defined by the limit. Let $\eta\colon 1 \to E$ be the unit and $\mu\colon E E \to E$ the multiplication of $E$. For each $\alpha$, there is a monad map $\pi_\alpha\colon E \to M_\alpha$ defined by the limit projection. 

+-- {: .un_lemma}
###### Claim
$E$ is idempotent. 
=--

For this it suffices to check that $\eta E = E \eta\colon E \to E E$. This may be checked objectwise. So fix an object $c$, and for that particular $c$, choose $\alpha$ so large that $\pi_\alpha (c)\colon E(c) \to M_\alpha(c)$ and $\pi_\alpha E(c)\colon E E(c) \to M_{\alpha} E(c)$ are isomorphisms. In particular, $\pi_\alpha \pi_\alpha(c)\colon E E (c) \to M_\alpha M_\alpha(c)$ is invertible. 

Now $u_\alpha M_\alpha(c) = M_{\alpha} u_{\alpha} c$, since $\pi_\alpha\colon E \to M_\alpha$ factors through the equalizer $M_{\alpha + 1} \hookrightarrow M_\alpha$. Because $\pi_\alpha$ is a monad morphism, we have 

$$\array{
\eta E(c) & = & (\pi_\alpha \pi_\alpha (c))^{-1} (u_\alpha M_\alpha(c))\pi_\alpha(c) \\
       & = & (\pi_\alpha \pi_\alpha (c))^{-1} (M_\alpha u_\alpha(c))\pi_\alpha(c) \\
       & = & E \eta(c)
}$$

as required. 

Finally we must check that $M \mapsto E(M)$ satisfies the appropriate universal property. Suppose $T$ is an idempotent monad with unit $v$, and let $\phi\colon T \to M$ be a monad map. We define $T \to M_\alpha$ by induction: given $\phi_\alpha\colon T \to M_\alpha$, we have 

$$(u_\alpha M_\alpha)\phi_\alpha = \phi_\alpha \phi_\alpha (v T) = \phi_\alpha \phi_\alpha (T v) = (M_\alpha u_{\alpha})\phi_\alpha$$ 

so that $\phi_{\alpha}$ factors uniquely through the inclusion $M_{\alpha + 1} \hookrightarrow M_\alpha$. This defines $\phi_{\alpha + 1}\colon T \to M_{\alpha + 1}$; this is a monad map. The definition of $\phi_\alpha$ at limit ordinals, where $M_\alpha$ is a limit monad, is clear. Hence $T \to M$ factors (uniquely) through the inclusion $E(M) \hookrightarrow M$, as was to be shown.  
=-- 


### Examples 

Let $A$ be a commutative ring, and let $f\colon A \to B$ be a flat (commutative) $A$-algebra. Then the forgetful functor 

$$f^\ast = Ab^f\colon Ab^B \to Ab^A$$ 

from $B$-modules to $A$-modules has a left exact left adjoint $f_! = B \otimes_A -$. The induced monad $f^\ast f_!$ on the category of $B$-modules preserves equalizers, and so its associated idempotent monad $T$ may be formed by taking the equalizer 

$$T(M) \to B \otimes_A M \stackrel{\overset{f^\ast f_! \eta M}{\to}}{\underset{\eta f^\ast f_! M}{\to}} B \otimes_A B \otimes_A M$$ 

(To be continued. This example is based on how Joyal and Tierney introduce effective descent for commutative ring homomorphisms, in An Extension of the Galois Theory of Grothendieck. I would like to consult that before going further -- Todd.) 

+-- {: .query}
[[Mike Shulman]]: How about some examples of monads and their associated idempotent monads?

Do 2-monads have associated lax-, colax-, or pseudo-idempotent 2-monads?
=--
 

## References

* [[Francis Borceux]], _Handbook of categorical algebra_, vol.2, p. 196.

* P. Gabriel and M. Zisman, _Calculus of Fractions and Homotopy Theory_


[[!redirects idempotent monad]]
[[!redirects idempotent monads]]
